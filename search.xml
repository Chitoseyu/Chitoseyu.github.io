<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>Linux常用語法</title>
    <url>/2021/12/22/Linux%E5%B8%B8%E7%94%A8%E8%AA%9E%E6%B3%95/</url>
    <content><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>開始整理大學時期研究的筆記</p>
<p>也替自己的學習做一點紀錄</p>
<p>放個Linux吉祥物做開頭吧</p>
<p><img src="/images/Linux_icon.png"></p>
<p>Linux作業系統有發行很多種版本</p>
<p>例如：CentOS、Ubuntu…等都算是Linux的一種</p>
<p>但終端機用的指令通常都大同小異</p>
<p>也藉由這文章做個整理</p>
<span id="more"></span>

<h1 id="Linux語法"><a href="#Linux語法" class="headerlink" title="Linux語法"></a>Linux語法</h1><p>以下依照功能用途來區分常用指令</p>
<h2 id="系統操作"><a href="#系統操作" class="headerlink" title="系統操作"></a>系統操作</h2><table>
<thead>
<tr>
<th>指令</th>
<th>說明</th>
<th>用法</th>
</tr>
</thead>
<tbody><tr>
<td>lsb_release</td>
<td>查看目前ubuntu版本</td>
<td>lsb_release -a</td>
</tr>
<tr>
<td>dpkg</td>
<td>列出安裝套件</td>
<td>dpkg -l  grep php</td>
</tr>
<tr>
<td>route</td>
<td>查看路由表</td>
<td>route -n</td>
</tr>
</tbody></table>
<h2 id="基本操作"><a href="#基本操作" class="headerlink" title="基本操作"></a>基本操作</h2><table>
<thead>
<tr>
<th>指令</th>
<th>說明</th>
<th align="left">用法</th>
</tr>
</thead>
<tbody><tr>
<td>ls</td>
<td>查看目前所在位置的所有檔案</td>
<td align="left">ls</td>
</tr>
<tr>
<td>mkdir</td>
<td>建立新資料夾</td>
<td align="left">mkdir html</td>
</tr>
<tr>
<td>cd</td>
<td>移動到該資料夾下</td>
<td align="left">cd html</td>
</tr>
<tr>
<td>passwd</td>
<td>使用者更改自己帳號的密碼</td>
<td align="left">Passwd</td>
</tr>
<tr>
<td>apt update</td>
<td>更新系統</td>
<td align="left">sudo apt update</td>
</tr>
<tr>
<td>apt upgrade</td>
<td>更新系統現有套件</td>
<td align="left">sudo apt upgrade</td>
</tr>
<tr>
<td>apt dist-upgrade</td>
<td>更新系統套件相依性</td>
<td align="left">sudo apt dist-upgrade</td>
</tr>
<tr>
<td>shutdown</td>
<td>系統關機(-c 取消關機 -r重新開機)</td>
<td align="left">sudo shutdown -h now</td>
</tr>
</tbody></table>
<h2 id="檔案處理"><a href="#檔案處理" class="headerlink" title="檔案處理"></a>檔案處理</h2><table>
<thead>
<tr>
<th>指令</th>
<th>說明</th>
<th align="left">用法</th>
</tr>
</thead>
<tbody><tr>
<td>nano(vi)</td>
<td>編輯器新增或編輯檔案(nano或vi 看使用者習慣)</td>
<td align="left">nano  index.html</td>
</tr>
<tr>
<td>mv</td>
<td>檔案改名或移動到特定位置</td>
<td align="left">mv index.html newIndex.html</td>
</tr>
<tr>
<td>find</td>
<td>尋找檔案(可在檔案名稱變化：?單字元、*多字元)</td>
<td align="left">find / -name newIndex.*</td>
</tr>
<tr>
<td>cp</td>
<td>複製檔案</td>
<td align="left">cp newIndex.html index.txt</td>
</tr>
</tbody></table>
<p>這邊說明檔案權限的區分規則</p>
<p>主要有三個用戶  User(個人) / Group(群組) / Other(其他) 順序排列</p>
<p><code>r :  可讀權限, 數字是 4</code></p>
<p><code>w : 寫入權限, 數字是 2</code></p>
<p><code>x :  執行權限, 數字是 1</code></p>
<p><code>-:  刪除權限, 數字是 0</code></p>
<p><strong>通常會是三個一組，採加法可得出數字</strong></p>
<p><code>7 = 4 (讀) + 2 (寫) + 1 (執行)</code></p>
<p><code>5 = 4 (讀) + 1 (執行)</code></p>
<p><code>4 = 4 (讀)</code></p>
<p>舉個例子</p>
<p>要使 index.html 個人可以讀寫執、群組讀寫、其他讀：</p>
<p>chmod rwx,rx,r index.html    </p>
<p>也等於</p>
<p>chmod 754 index.html</p>
<h2 id="使用者管理"><a href="#使用者管理" class="headerlink" title="使用者管理"></a>使用者管理</h2><table>
<thead>
<tr>
<th>指令</th>
<th>說明</th>
<th align="left">用法</th>
</tr>
</thead>
<tbody><tr>
<td>cat</td>
<td>預覽檔案全部內容並印出</td>
<td align="left">cat index.html</td>
</tr>
<tr>
<td>/etc/group</td>
<td>目前系統存在的群組</td>
<td align="left">cat /etc/group</td>
</tr>
<tr>
<td>groups</td>
<td>查看帳號群組</td>
<td align="left">groups</td>
</tr>
<tr>
<td>groupadd</td>
<td>新增群組(G_ID:不重複的五位數 G_NAME:群組名稱)</td>
<td align="left">groupadd -g G_ID G_Name</td>
</tr>
<tr>
<td>/etc/passwd</td>
<td>目前系統存在的帳號</td>
<td align="left">cat /etc/passwd</td>
</tr>
<tr>
<td>useradd</td>
<td>新增使用者帳號(U_ID:不重複的數字 G:加入的群組 -m:建立目錄 U_N:使用者帳號）</td>
<td align="left">useradd -u U_ID -g G -m U_N</td>
</tr>
<tr>
<td>userdel</td>
<td>刪除使用者帳號(-r:連家目錄一起刪除)</td>
<td align="left">userdel -r U_N</td>
</tr>
<tr>
<td>su</td>
<td>管理帳號與使用者帳號切換</td>
<td align="left">su -l U_N</td>
</tr>
</tbody></table>
]]></content>
      <categories>
        <category>技術筆記</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title>Markdown語法筆記</title>
    <url>/2021/04/07/Markdown%E8%AA%9E%E6%B3%95%E7%AD%86%E8%A8%98/</url>
    <content><![CDATA[<p>整理一些比較常用的語法紀錄</p>
<hr>
<h1 id="標題"><a href="#標題" class="headerlink" title="標題"></a>標題</h1><p><strong>#當標題使用，越少字越大，最多6個</strong></p>
<pre><code>## 第二段 (H2)
### 第三段(H3)
</code></pre>
<p>效果如下</p>
<h2 id="第二段-H2"><a href="#第二段-H2" class="headerlink" title="第二段 (H2)"></a>第二段 (H2)</h2><h3 id="第三段-H3"><a href="#第三段-H3" class="headerlink" title="第三段(H3)"></a>第三段(H3)</h3><span id="more"></span>


<h1 id="刪除線"><a href="#刪除線" class="headerlink" title="刪除線"></a>刪除線</h1><p><strong>句子前後都加 ~~ 會有刪除線效果</strong></p>
<pre><code>~~我是刪除線~~
</code></pre>
<p>效果如下</p>
<p><del>我是刪除線</del></p>
<h1 id="常用文字效果"><a href="#常用文字效果" class="headerlink" title="常用文字效果"></a>常用文字效果</h1><h2 id="粗體"><a href="#粗體" class="headerlink" title="粗體"></a>粗體</h2><pre><code>**Bold**  or __Bold__
</code></pre>
<p>效果如下</p>
<p><strong>Bold</strong></p>
<h2 id="斜體"><a href="#斜體" class="headerlink" title="斜體"></a>斜體</h2><pre><code>*Italic*  or _Italic_
</code></pre>
<p>效果如下</p>
<p><em>Italic</em></p>
<h2 id="字體顏色"><a href="#字體顏色" class="headerlink" title="字體顏色"></a>字體顏色</h2><p>這部分可以直接套用HTML語法，顏色可以參考<a href="https://www.ifreesite.com/color/">網頁色碼表</a></p>
<pre><code>* &lt;font color = &quot;#FF0000&quot;&gt;紅色文字&lt;/font&gt;
* &lt;font color = &quot;00A600&quot;&gt;綠色文字&lt;/font&gt;
* &lt;font color = &quot;#0000C6&quot;&gt;藍色文字&lt;/font&gt;
</code></pre>
<p>效果如下 </p>
<ul>
<li><font color = "#FF0000">紅色文字</font></li>
<li><font color = "00A600">綠色文字</font></li>
<li><font color = "#0000C6">藍色文字</font></li>
</ul>
<h2 id="特殊符號"><a href="#特殊符號" class="headerlink" title="特殊符號"></a>特殊符號</h2><p>**如果需要打特殊符號但跟前面的有重複到，記得在符號前加上反斜線 \ ，特殊符號如下 **</p>
<pre><code>*
!
+
-
[]
&#123;&#125;
#
!
</code></pre>
<h2 id="區塊引言"><a href="#區塊引言" class="headerlink" title="區塊引言"></a>區塊引言</h2><p>** 在每行前面 加上 &gt; 或是在區塊的第一行加上 &gt; **</p>
<pre><code>&gt; 哈哈
&gt; 區塊引言
&gt; &gt; 多加就會換行
</code></pre>
<p>效果如下</p>
<blockquote>
<p>哈哈<br>區塊引言</p>
<blockquote>
<p>多加就會換行</p>
</blockquote>
</blockquote>
<h2 id="分隔線"><a href="#分隔線" class="headerlink" title="分隔線"></a>分隔線</h2><p><strong>分隔線的部分就很自由了，只要有三個以上的 * or _ or - 都會出來，不管中間有沒有空格</strong> </p>
<pre><code>***
_ _ _ _ _
------------
</code></pre>
<p>效果如下</p>
<hr>
<h1 id="清單"><a href="#清單" class="headerlink" title="清單"></a>清單</h1><p><strong>前面一個 * or + or - 當一般清單(就是沒有1.、2.、3.、…etc)</strong></p>
<pre><code>* 第一個
 * 第二個
* 第三個
</code></pre>
<p>效果如下</p>
<ul>
<li>第一個</li>
<li>第二個</li>
<li>第三個</li>
</ul>
<p><strong>想要有序清單就正常打</strong></p>
<pre><code>1. 第一個
2. 第二個
</code></pre>
<p>效果如下   </p>
<ol>
<li>第一個</li>
<li>第二個</li>
</ol>
<h1 id="文字大區塊"><a href="#文字大區塊" class="headerlink" title="文字大區塊"></a>文字大區塊</h1><p><strong>要用大區塊將文字包起來可以按四個空白或是一個Tab</strong></p>
<pre><code>echo &quot;Hello World!&quot;
</code></pre>
<h1 id="文字小區塊"><a href="#文字小區塊" class="headerlink" title="文字小區塊"></a>文字小區塊</h1><p><strong>要用小區塊將文字包起來前後都加上 ` 反引號</strong></p>
<p><code>echo &quot;Hello World!&quot;</code></p>
<h1 id="程式碼區塊"><a href="#程式碼區塊" class="headerlink" title="程式碼區塊"></a>程式碼區塊</h1><p><strong>程式碼區塊在開頭結尾加上```可以顯示</strong></p>
<p>要加上Highlight  以JS為例就是 js 或 javascript 在前面的 ``` 加上 js 或 javascript 就有囉</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">document</span>.write(<span class="string">&quot;歡迎光臨&quot;</span>) </span><br></pre></td></tr></table></figure>
<h1 id="超連結"><a href="#超連結" class="headerlink" title="超連結"></a>超連結</h1><p><strong>需要超連結的格式</strong></p>
<p><code>[要顯示的名稱](網址)</code></p>
<h1 id="圖片"><a href="#圖片" class="headerlink" title="圖片"></a>圖片</h1><p><code>![若圖片顯示不出來的文字](圖片連結位置或網址)</code></p>
<p>效果如下，用原生的沒辦法設定大小，可以改用HTML的　img　標籤來設定</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;圖片網誌或存放路徑&quot;</span>  <span class="attr">width</span>=<span class="string">&quot;300&quot;</span> <span class="attr">height</span>=<span class="string">&quot;300&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="HTML的img做出來的效果"><a href="#HTML的img做出來的效果" class="headerlink" title="HTML的img做出來的效果"></a>HTML的img做出來的效果</h2><img src="https://i.imgur.com/8Kwd2ko.jpg"  width="300" height="300">

<h2 id="Markdown做出來的效果"><a href="#Markdown做出來的效果" class="headerlink" title="Markdown做出來的效果"></a>Markdown做出來的效果</h2><p><img src="https://i.imgur.com/8Kwd2ko.jpg" alt="沒錯原生圖檔就這麼大"></p>
<h1 id="參考資料"><a href="#參考資料" class="headerlink" title="參考資料"></a>參考資料</h1><p><a href="https://markdown.tw/">Markdown語法說明</a></p>
]]></content>
      <categories>
        <category>技術筆記</category>
      </categories>
      <tags>
        <tag>Markdown</tag>
      </tags>
  </entry>
  <entry>
    <title>MongoDB入門手冊</title>
    <url>/2021/08/19/MongoDB%E5%85%A5%E9%96%80%E6%89%8B%E5%86%8A/</url>
    <content><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>照慣例在文章開頭放個圖片</p>
<p><img src="/images/mongodb.png"></p>
<p>作為近幾年開始熱門討論的 NoSQL資料庫，有非常強大的社群及網路討論聲量，本身也有分成安裝版跟免安裝版本，大部分網路上教學都是安裝版，因為有安裝就會有預設路徑 = 少做路徑設定</p>
<p>對於第一次操作的人可能都會是這個表情，這就是學習新技術痛苦的地方啊…<br><img src="/images/cat.jpg"  width="300" height="300"></p>
<p>我在操作時使用免安裝版，優點就是可以隨時帶著走，但路徑出錯直接運作不起來</p>
<p>這部分就交給讀者自行選擇版本囉 ~ </p>
<p>在學習途中做個資料整理，提供正在學的人能避免做無用功浪費時間，有錯誤歡迎留言指正！</p>
<span id="more"></span>
<hr>
<h1 id="MongoDB設定細節"><a href="#MongoDB設定細節" class="headerlink" title="MongoDB設定細節"></a>MongoDB設定細節</h1><h2 id="安裝本機背景服務設定-Windows環境下-："><a href="#安裝本機背景服務設定-Windows環境下-：" class="headerlink" title="安裝本機背景服務設定(Windows環境下)："></a>安裝本機背景服務設定(Windows環境下)：</h2><p>讓MongoDB可以在背景啟動，mongodb.cfg是設定檔，寫法可參考下文所寫格式</p>
<p><code>mongod --config &quot;C:\你的安裝路徑\bin\mongodb.cfg&quot; --serviceName &quot;MongoDB&quot; --serviceDisplayName &quot;MongoDB&quot; --install</code></p>
<p>在安裝的時候一起把設定檔讀入就不需要打前面那一大串了</p>
<p>讀取設定檔語法可以參照下面寫的 把設定路徑的部分改成讀取設定檔也行</p>
<p>筆者目前資料夾分布有以下(可自由設定)</p>
<pre><code>#資料庫存放的地方
C:/mongodb/data/db              
#備份存放的地方
C:/mongodb/data/backup        
#日誌檔存放的地方
C:/mongodb/data/log            
</code></pre>
<p>安裝成功使用以下可以看到服務啟動的提示，如果沒反應可能有地方打錯就重新安裝一次吧</p>
<h3 id="背景啟動指令："><a href="#背景啟動指令：" class="headerlink" title="背景啟動指令："></a>背景啟動指令：</h3><pre><code>net start MongoDB
</code></pre>
<h3 id="背景關閉指令："><a href="#背景關閉指令：" class="headerlink" title="背景關閉指令："></a>背景關閉指令：</h3><pre><code>net stop MongoDB
</code></pre>
<p>命令提示字元(Cmd)登入MongoDB：</p>
<p>若今天要用 asd1234帳號登入mongoDB存取mongodb，27012是當初設定的port</p>
<pre><code>mongo -u asd1234 -p zxc1234 --port 27012
</code></pre>
<p>以下指令可以在mongodb啟動時更改路徑</p>
<p>資料庫存放路徑：</p>
<p><code>mongod --dbpath=C:\mongodb\data</code>                       </p>
<p>Log檔案存放路徑：</p>
<p><code>mongod --logpath=C:\mongodb\log\mongod.log</code>    </p>
<p>讀取設定檔案路徑：</p>
<p><code>mongod --config &quot;C:\mongodb\bin\mongod.cfg&quot;</code>     </p>
<h2 id="mongod-cfg格式-注意縮排與空格-："><a href="#mongod-cfg格式-注意縮排與空格-：" class="headerlink" title="mongod.cfg格式(注意縮排與空格)："></a>mongod.cfg格式(注意縮排與空格)：</h2><pre><code>  storage:           #DB存放設定
      dbPath: C:\mongodb\data\db
      journal:    
        enabled: true
  systemLog:           #日誌檔存放設定
      destination: file
      logAppend: true 
      path: C:\mongodb\log\mongod.log
  security:
     authorization: enabled
  net:
     port: 27123        #綁定的PORT
     bindIp : 0.0.0.0   #允許遠端的所有IP
</code></pre>
<h1 id="MongoDB指令整理"><a href="#MongoDB指令整理" class="headerlink" title="MongoDB指令整理"></a>MongoDB指令整理</h1><p><strong>&lt;&gt; 、{} =&gt; 表示名稱，省略不打</strong></p>
<h2 id="資料庫操作"><a href="#資料庫操作" class="headerlink" title="資料庫操作"></a>資料庫操作</h2><pre><code>#顯示目前所在資料庫
db                                                
#檢視所有資料庫
show  dbs                                    
#檢視所有使用者
show  users                                 
#切換資料庫，原本沒有會自己新建一個，空DB不會顯示在檢視
use &lt;DB名稱&gt;                             
#檢視DB裡面的table，也能稱collection
show tables/collections                
#顯示table資料筆數
db.&lt;table名稱&gt;.count()                
</code></pre>
<h2 id="插入資料"><a href="#插入資料" class="headerlink" title="插入資料"></a>插入資料</h2><pre><code>#創建table，不過直接在插入資料時直接寫也行
db.createCollection(&quot;table名稱&quot;)  

#AND語法
db.&#123;collection名稱&#125;.find(&#123;&quot;欄位名稱&quot;:&quot;資料內容&quot;, &quot;欄位名稱&quot;:&quot;資料內容&quot;&#125;).pretty()
#OR語法
db.&#123;collection名稱&#125;.find(&#123;$or: [&#123;&quot;欄位名稱&quot;:&quot;資料內容&quot;&#125;, &#123;&quot;欄位名稱&quot;:&quot;資料內容&quot;&#125;]&#125;).pretty()
#兩者組合
db.&#123;collection名稱&#125;.find(&#123;&quot;欄位名稱&quot;:&#123;$gt:50&#125;,$or:[&#123;&quot;欄位名稱&quot;:&quot;資料內容&quot;&#125;,&#123;&quot;欄位名稱&quot;:&quot;資料內容&quot;&#125;]&#125;).pretty()
</code></pre>
<p>以下對 ({要插入的資料內容篩選條件}) 符號說明</p>
<pre><code>#等於50
&quot;by&quot;:&quot;50&quot;         
#小於50
&quot;欄位名稱&quot;:&#123;$lt:50&#125;    
#小於等於50    
&quot;欄位名稱&quot;:&#123;$lte:50&#125;  
#大於50
&quot;欄位名稱&quot;:&#123;$gt:50&#125;   
 #大於等於50
&quot;欄位名稱&quot;:&#123;$gte:50&#125; 
 #不等於
&quot;欄位名稱&quot;:&#123;$ne:50&#125;  
</code></pre>
<p>若碰上要一次插入多筆資料的情況</p>
<p>[  ]  → 多筆資料包起來，每筆資料逗號分隔</p>
<p>“  “  → 欄位名稱跟內容沒有也能插資料，通常是只有內容有 “ “ </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">db.pets.insertMany([</span><br><span class="line">  &#123;</span><br><span class="line"></span><br><span class="line">    &quot;name&quot; : &quot;Daisy&quot;,</span><br><span class="line"></span><br><span class="line">    &quot;species&quot; : &quot;cat&quot;,</span><br><span class="line"></span><br><span class="line">    &quot;breed&quot; : &quot;calico&quot;</span><br><span class="line"></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    &quot;name&quot;:&quot;Bella&quot;,</span><br><span class="line"></span><br><span class="line">    &quot;species&quot;:&quot;dog&quot;,</span><br><span class="line"></span><br><span class="line">    &quot;breed&quot;:&quot;australian shepard&quot;</span><br><span class="line">  &#125;</span><br><span class="line">])</span><br></pre></td></tr></table></figure>
<h2 id="刪除資料庫"><a href="#刪除資料庫" class="headerlink" title="刪除資料庫"></a>刪除資料庫</h2><pre><code>#在DB底下操作才能刪除該資料庫
db.dropDatabase()   
#刪除table
db.&lt;table名稱&gt;.drop()   
#找到table有包含到該內容就刪除
db.&lt;table名稱&gt;.remove(&#123;欄位名稱 : 欄位內容,...&#125;)  
#全刪除
db.&lt;table名稱&gt;.remove()   
</code></pre>
<h2 id="搜尋資料庫內容"><a href="#搜尋資料庫內容" class="headerlink" title="搜尋資料庫內容"></a>搜尋資料庫內容</h2><pre><code>#回傳第一筆資料
db.&lt;table名稱&gt;.findOne()   
#回傳全部資料，pretty是讓顯示有間距好看
db.&lt;table名稱&gt;.find().pretty()  
</code></pre>
<h2 id="資料庫內容更新"><a href="#資料庫內容更新" class="headerlink" title="資料庫內容更新"></a>資料庫內容更新</h2><p><code>db.&lt;table名稱&gt;.update(&#123;name:&quot;MongoDB&quot;,其他欄位:欄位內容...&#125;,&#123;$set:&#123;name:&quot;Jack&quot;,其他欄位:欄位內容...&#125;&#125;,&#123;multi:true&#125;)</code></p>
<pre><code>&#123;name:&quot;MongoDB&quot;,其他欄位:欄位內容...&#125;：要更新的資料
&#123;$set:&#123;name:&quot;Jack&quot;,其他欄位:欄位內容...&#125;&#125;：從舊資料找符合內容的目標
&#123;multi:true&#125;：若要一次更新多筆要true
</code></pre>
<h2 id="資料庫備份"><a href="#資料庫備份" class="headerlink" title="資料庫備份"></a>資料庫備份</h2><p>指令如下</p>
<p><code>mongodump -h 127.0.0.1 --port 27120 -u root -p root1234 -d Number -o C:/mongodb/data/backup --authenticationDatabase admin</code></p>
<p>參數說明：</p>
<pre><code>#host,表示資料庫主機的IP位置或是電腦名稱
-h        
#user,登入的帳號
-u         
#password,登入的密碼
-p         
#指定port號
--port     
#database,備份資料庫的名稱
-d         
#collection,指定備份某一個Collection
-c         
 #output備份輸出的磁碟位置(Folder Path) 要備份在哪個磁碟要打不然會在奇怪地方
-o        
#開啟授權的資料庫需要加上否則無法使用
--authenticationDatabase admin 
</code></pre>
<p><strong>備份前最好先移動到 mongoDB 的  admin 資料庫下面</strong></p>
<p>使用以下指令<br>    #磁碟同步與上鎖<br>    db.runCommand({fsync:1,lock:1})<br>    #查看上鎖狀態 fsyncLock true 代表成功<br>    db.currentOp()<br>    #備份完成記得解鎖<br>    db.fsyncUnLock()</p>
<h2 id="資料庫還原"><a href="#資料庫還原" class="headerlink" title="資料庫還原"></a>資料庫還原</h2><p>指令如下</p>
<p><code>mongorestore -h 127.0.0.1 --port 27120 -d Number -u root -p root1234 --authenticationDatabase admin --dir C:/mongodb/data/backup/Number --drop</code></p>
<pre><code>#host,表示資料庫主機的IP位置或是電腦名稱
-h         
#user,登入的帳號
-u         
#password,登入的密碼
-p         
#指定port號
--port
#database,備份資料庫的名稱
-d        
#備份DB的磁碟位置(Folder Path) 要備份在哪個磁碟要打不然會在奇怪地方
-dir     
 #開啟授權的資料庫需要加上否則無法使用
--authenticationDatabase admin
#若Server有相同DB會先刪除再還原回去(因有相同名稱不能還原)，小心使用    
--drop  
</code></pre>
<h1 id="MongoDB遠端連線"><a href="#MongoDB遠端連線" class="headerlink" title="MongoDB遠端連線"></a>MongoDB遠端連線</h1><p><strong>沒有設定Auth沒辦法開放給其他電腦使用</strong></p>
<h2 id="設定Auth步驟"><a href="#設定Auth步驟" class="headerlink" title="設定Auth步驟"></a>設定Auth步驟</h2><ol>
<li><p>先移動到admin DB下操作</p>
</li>
<li><p>創建管理所有DB的管理帳號(最一開始需要的帳號)</p>
</li>
</ol>
<p> <code>db.createUser(&#123;user: &quot;asd1234&quot;,pwd: &quot;zxc1234&quot;,roles: [&#123; role: &quot;root&quot;, db: &quot;admin&quot; &#125;]&#125;)</code></p>
<ol start="3">
<li>再啟動MongoDB時開啟認證</li>
</ol>
<p> <code>mongod --auth </code></p>
<ol start="4">
<li><p>之後使用mongo進去就看不到所有資料庫狀態了</p>
<p> 一開始沒輸入帳號進去想登入管理者帳號就要移動到admin下使用語法：</p>
</li>
</ol>
<p> <code>db.auth(&quot;root&quot;, &quot;PASSWORD&quot;) </code></p>
<p>  在使用MongoDB的Shell開始就登入的語法：</p>
<p>  <strong>連接Port預設27017,遠端開放要改</strong></p>
<p>  <code>mongo -u 使用者帳號 -p 使用者密碼 --port 連接Port</code></p>
<ol start="5">
<li><p>能對不同資料庫增加不同使用者並設定權限</p>
<p> <code>db.createUser(&#123;user: &quot;使用者名稱&quot;,pwd: &quot;密碼&quot;,roles: [&#123; role: &quot;root/readWrite/read&quot;, db: &quot;資料庫名稱&quot; &#125;]&#125;)</code></p>
<ul>
<li>root #最大  </li>
<li>read #只能讀  </li>
<li>readWrite #能讀寫</li>
</ul>
</li>
</ol>
<p>補充用戶設定的相關指令<br>     #更新用戶權限<br>    db.updateUser(user, writeConcern)<br>    #在DB的 test 下創使用者<br>    db.createUser({ user:”asd1234”, pwd:”zxc1234”, roles:[“readWrite”, “dbAdmin”] })<br>    #遠端連線( / 為二選一)<br>    mongo [IP] / [database] -u username -p password</p>
<p>權限補充說明(部分)：</p>
<pre><code>dbAdmin
在指定DB中執行管理函數，如創建删除和查看資料表
userAdmin
可以在系統的users集合寫入，找指定DB創建删除和管理使用者
clusterAdmin
只在admin中可用，給使用者所有分片和複製集相關函數的管理權限
readAnyDatabase
只在admin中可用，給使用者所有DB的讀取權限
readWriteAnyDatabase
只在admin中可用，給使用者所有DB的讀寫權限 
</code></pre>
<h3 id="Auth可能會發生的問題"><a href="#Auth可能會發生的問題" class="headerlink" title="Auth可能會發生的問題"></a>Auth可能會發生的問題</h3><p><strong>若直接從設定檔開啟授權會導致無法遠端連線</strong></p>
<p><strong>要針對個別DB設置使用者再透過指令授權連線</strong></p>
<pre><code>#修改密碼
db.changeUserPassword(&quot;user123&quot;,&quot;password456&quot;)           
#刪除帳戶
db.dropUser(&quot;user123&quot;)   
</code></pre>
<h2 id="遠端電腦連線mongoDB"><a href="#遠端電腦連線mongoDB" class="headerlink" title="遠端電腦連線mongoDB"></a>遠端電腦連線mongoDB</h2><p>指令如下</p>
<pre><code>mongo &quot;mongodb://mongodb.test.com:連線的port&quot;
mongo --host mongodb.test.com:連線的port
mongo --host mongodb.test.com --port 連線的port
</code></pre>
<p>參數說明<br>    #連線地址(如mongodb.test.com ，也可以是 IP位置)<br>    –host <hostname></p>
<p>舉個例子<br>，使用者 root連線至admin DB使用</p>
<p>[  ]請依情況變化</p>
<p><code>mongo --host [192.168.xx.xxx] --port [27120] -u [&quot;root&quot;]  -p --authenticationDatabase [&quot;admin&quot;]</code></p>
<h1 id="MongoDB在-Centos-7環境操作"><a href="#MongoDB在-Centos-7環境操作" class="headerlink" title="MongoDB在 Centos 7環境操作"></a>MongoDB在 Centos 7環境操作</h1><p><strong>有時無法啟動檢查相關資料夾是否存在去看log檔案檢查是否為權限問題</strong></p>
<h2 id="更改Port很容易出現的問題"><a href="#更改Port很容易出現的問題" class="headerlink" title="更改Port很容易出現的問題"></a>更改Port很容易出現的問題</h2><pre><code>#如果不存在才新增沒有的資料夾
sudo mkdir /var/lib/mongodb                                
#設定資料夾權限  mongo為使用者名稱
sudo chown -R mongo:mongo /var/lib/mongodb   
#重設權限給mongod  改port 後就好了
sudo chown -R mongod:mongod /var/lib/mongo    
</code></pre>
<h2 id="沒設定授權用預設端口容易入侵被改內容"><a href="#沒設定授權用預設端口容易入侵被改內容" class="headerlink" title="沒設定授權用預設端口容易入侵被改內容"></a>沒設定授權用預設端口容易入侵被改內容</h2><pre><code>#啟動Mongodb
sudo service mongod start  /   systemctl start mongod.service    
#重啟Mongodb
sudo service mongod restart
#關閉Mongodb
sudo service mongod stop      
#查看目前狀態
systemctl status mongod.service 
</code></pre>
<p>如何正確關閉mongoDB<br>    1. mongo<br>    2. use admin<br>    3. db.shutdownServer()</p>
<p>如果以上指令還是無法解決就是重裝，重裝解決95%問題👌<br>    #卸載MongoDB<br>    sudo yum erase $(rpm -qa | grep mongodb-org)<br>    #刪除 log<br>    sudo rm -r /var/log/mongodb<br>    #對MongoDB設定檔修改<br>    nano  /etc/mongod.conf<br>     → 要開關帳號權限進去改完存檔重新啟動MongoDB</p>
<p>開放對外的端口方法：<br>    #查看防火牆狀態<br>    systemctl status firewalld<br>    #防火牆重載<br>    firewall-cmd –reload<br>    #開放PORT狀態  YES成功<br>    firewall-cmd –zone=public –query-port=27017/tcp<br>    #開放MongoDB PORT<br>    firewall-cmd –zone=public –add-port=27017/tcp –permanent   </p>
<h1 id="MongoDB-Cloud服務"><a href="#MongoDB-Cloud服務" class="headerlink" title="MongoDB  Cloud服務"></a>MongoDB  Cloud服務</h1><p>MongoDB Atlas 學術用512MB，官方近幾年在推的，我用過後覺得容量太小，有興趣可以參考</p>
<p>網誌在這 → <a href="https://www.mongodb.com/cloud/atlas/lp/try2?utm_source=google&utm_campaign=gs_apac_taiwan_search_brand_atlas_desktop&utm_term=mongodb%20cloud&utm_medium=cpc_paid_search&utm_ad=e&utm_ad_campaign_id=6498554090&gclid=CjwKCAjwgviIBhBkEiwA10D2j_c5k68hdbzBgb-OhwwLksgPAiIBf72pf4nfJskX6768fxCgt8OyIBoC7GIQAvD_BwE">MongoDB Atlas</a></p>
<h1 id="參考資料"><a href="#參考資料" class="headerlink" title="參考資料"></a>參考資料</h1><ul>
<li><a href="https://docs.mongodb.com/manual/tutorial/install-mongodb-on-red-hat/">官方Centos7安裝文件</a></li>
<li><a href="https://www.digitalocean.com/community/questions/mongo-cant-start-service">Mongo can not start service(權限問題)</a></li>
</ul>
]]></content>
      <categories>
        <category>技術筆記</category>
      </categories>
      <tags>
        <tag>MongoDB</tag>
        <tag>NoSQL</tag>
      </tags>
  </entry>
  <entry>
    <title>Python地址轉換地圖經緯度</title>
    <url>/2021/08/23/Python%E5%9C%B0%E5%9D%80%E8%BD%89%E6%8F%9B%E5%9C%B0%E5%9C%96%E7%B6%93%E7%B7%AF%E5%BA%A6/</url>
    <content><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>在實作地圖的時候多少會遇到資料只有地址的情況</p>
<p>以最常見的Google map來說，要標記一個地點就需要經緯度</p>
<p>當然Google本身也有提出對應的API → Geocoding(地理編碼)服務</p>
<p>簡單來說能直接把地址經查詢後轉經緯度回傳，當回傳次數一多就會有收費的問題了…</p>
<p><strong>那這時候需要處理大量資料的工程師怎麼辦呢?</strong></p>
<span id="more"></span>

<ol>
<li>台灣內政部有提供一個全國門牌地址地位服務<br>(<a href="https://www.tgos.tw/TGOS/Web/Address/TGOS_Address.aspx">門牌地址地位服務</a>)</li>
</ol>
<p>  <strong><font color = "dd0000">該服務要申請會員，每日上限10000筆 </font></strong></p>
<p>  只要選擇篩選的情況(接受模糊地段等)，將資料整理成規定格式上傳後，處理完後會寄到信箱(約一小時左右)</p>
<p>  就我嘗試過的情況來說，太嚴格幾乎是抓不到東西，沒怎麼設定可能地址對照出來是別的街道…</p>
<ol start="2">
<li><p>Python 網頁爬蟲，透過電腦控制網頁開啟執行重複的動作取得經緯度，也是本文要說的重點</p>
<p> 在資訊如此發達的現代，網路上爬蟲教學文多到不行，我也試著留下作法讓後人可以少走冤枉路</p>
</li>
</ol>
<hr>
<h1 id="執行環境"><a href="#執行環境" class="headerlink" title="執行環境"></a>執行環境</h1><p>以下程式碼在 Python3.6.8 可以使用，3.4以上的應該都適用</p>
<p>若電腦沒裝python，請去<a href="https://www.python.org/">python官網</a></p>
<ol>
<li>Downloads</li>
<li>All releases</li>
<li>選擇適合版本</li>
<li>直接安裝到底</li>
</ol>
<p>終端機(cmd)執行以下指令可以看python版本</p>
<pre><code>python -V
</code></pre>
<p>安裝Python自動化模組(<a href="https://selenium-python.readthedocs.io/locating-elements.html">官方文件</a>)</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">pip install selenium</span><br></pre></td></tr></table></figure>
<p>當然要開什麼瀏覽器需要去抓那瀏覽器對應的驅動程式(**Driver.exe)</p>
<p>以Google瀏覽器為例(<a href="https://sites.google.com/a/chromium.org/chromedriver/downloads">驅動程式下載</a>)，選擇自己Chrome的版本下載</p>
<p>怎麼看自己的Chrome版本</p>
<ol>
<li>點選網頁右上角頭像旁邊三個點</li>
<li>選擇設定</li>
<li>關於Google</li>
</ol>
<p><strong>下載完記得跟Python程式放在同一資料夾</strong></p>
<p>安裝偽裝用戶代理模組</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">pip install fake_useragent</span><br></pre></td></tr></table></figure>
<p>爬蟲若是爬得過於頻繁就會被網頁偵測到，這時候只能在開啟的網頁下點功夫，舉例來說，正常開啟網頁做操作會有個請求的表頭，下面這段就是正常打開做請求的時候會送出的Useragent(用戶代理)</p>
<p><code>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.159 Safari/537.36</code></p>
<p>會顯示用戶作業系統、瀏覽器版本等等的資訊，有些網頁擋爬蟲是看這個(部分是看IP請求次數)</p>
<p>若重複的代理一直送請求容易很快就被擋，這地方做點偽裝延後被擋的時間</p>
<h1 id="Python程式"><a href="#Python程式" class="headerlink" title="Python程式"></a>Python程式</h1><p>接著就是選定要爬蟲的網頁，以<a href="https://www.map.com.tw/">台灣電子地圖服務網</a>為例子</p>
<p>以下程式碼會依 <strong>功能</strong> 分部分做解說</p>
<h2 id="網頁自動化"><a href="#網頁自動化" class="headerlink" title="網頁自動化"></a>網頁自動化</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"></span><br><span class="line">chrome_options = webdriver.ChromeOptions() </span><br><span class="line">browser = webdriver.Chrome(options=chrome_options) <span class="comment">#載入瀏覽器設定 </span></span><br><span class="line">targetUrl = <span class="string">&#x27;https://www.map.com.tw/&#x27;</span></span><br><span class="line">browser.get(targetUrl)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>上面程式碼執行後會開啟目標網頁，不做任何動作</p>
<p>瀏覽器此時會有一則提示寫著：目前被自動化程式控制</p>
<p>另外開啟的瀏覽器也有設定可以調整，以下提供幾個參考</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> fake_useragent <span class="keyword">import</span> UserAgent</span><br><span class="line"></span><br><span class="line"><span class="comment">#禁用瀏覽器彈窗設定</span></span><br><span class="line">prefs = &#123;</span><br><span class="line">    <span class="string">&#x27;profile.default_content_setting_values&#x27;</span>:</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">&#x27;notifications&#x27;</span>: <span class="number">2</span></span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line">ua = UserAgent()</span><br><span class="line"></span><br><span class="line">chrome_options = webdriver.ChromeOptions()</span><br><span class="line"></span><br><span class="line"><span class="comment">#不開視窗</span></span><br><span class="line">chrome_options.add_argument(<span class="string">&quot;--headless&quot;</span>)</span><br><span class="line"><span class="comment">#關閉GPU優化</span></span><br><span class="line">chrome_options.add_argument(<span class="string">&quot;--disable-gpu&quot;</span>)</span><br><span class="line"><span class="comment">#不載圖片</span></span><br><span class="line">chrome_options.add_argument(<span class="string">&#x27;blink-settings=imagesEnabled=false&#x27;</span>) </span><br><span class="line"><span class="comment">#使用者代理更換</span></span><br><span class="line">chrome_options.add_argument(<span class="string">&quot;user-agent=&#123;&#125;&quot;</span>.<span class="built_in">format</span>(ua.random))</span><br><span class="line"> <span class="comment">#隱藏打印日誌及自動化提示</span></span><br><span class="line">chrome_options.add_experimental_option(<span class="string">&quot;excludeSwitches&quot;</span>, [<span class="string">&quot;enable-logging&quot;</span>,<span class="string">&quot;enable-automation&quot;</span>])</span><br><span class="line"><span class="comment">#禁用瀏覽器彈窗</span></span><br><span class="line">chrome_options.add_experimental_option(<span class="string">&#x27;prefs&#x27;</span>,prefs)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>接著說明模組基本操作的方式，由於該模組是模擬人在網頁上的操作，只要網頁上有的東西都能抓</p>
<p>提供以下方式抓取網頁元素</p>
<pre><code>find_element_by_id
find_element_by_name
find_element_by_xpath                 
find_element_by_link_text
find_element_by_partial_link_text
find_element_by_tag_name
find_element_by_class_name
find_element_by_css_selector
</code></pre>
<p>有網頁開發基礎的應該不陌生，網頁元素都會有一些屬性存在</p>
<p>例如我要在台灣電子地圖上找到搜尋框，那我程式碼基於上面基礎可以再加上</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">addr = <span class="string">&#x27;臺北市中正區延平南路96號&#x27;</span></span><br><span class="line">search = browser.find_element_by_id(<span class="string">&#x27;searchWord&#x27;</span>) <span class="comment">#找到網頁上id 相等的元素</span></span><br><span class="line">search.clear()    								<span class="comment">#清除輸入框預設值</span></span><br><span class="line">search.send_keys(addr)							<span class="comment">#送出輸入值</span></span><br></pre></td></tr></table></figure>
<p>這程式會使網頁自動輸入地址並送出</p>
<p>不知道怎麼看網頁名稱的可以按下F12，選擇想看元素的位置就會右邊原始碼部分就會亮起</p>
<p>如果要用xpath定位參考下圖所示，複製到的就是網頁元素的XPATH<br><img src="/images/python_browser_1.png" alt="網頁爬蟲說明-1"></p>
<p>其他抓取元素的資訊一樣透過這方法來看，會了這個之後基本上就是熟悉語法的問題了</p>
<p>熟悉操作流程後來整理一下網頁的動作需求</p>
<ol>
<li>Python開啟網頁</li>
<li>在地圖搜尋框輸入特定地址後送出</li>
<li>找到位置後會出現該地址的資訊</li>
<li>點選座標的按鈕後網頁會顯示該地點經緯度</li>
<li>取得網頁顯示的經緯度後回傳</li>
<li>Python關閉網頁</li>
</ol>
<p>整理好需求後程式會長這樣，把流程寫成一個Python函式，地址在呼叫的時候給</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_coordinate</span>(<span class="params">addr</span>):</span></span><br><span class="line">  chrome_options = webdriver.ChromeOptions() </span><br><span class="line">  browser = webdriver.Chrome(options=chrome_options) </span><br><span class="line">  targetUrl = <span class="string">&#x27;https://www.map.com.tw/&#x27;</span></span><br><span class="line">  browser.get(targetUrl)</span><br><span class="line">  search = browser.find_element_by_id(<span class="string">&#x27;searchWord&#x27;</span>) </span><br><span class="line">  search.clear()                                    </span><br><span class="line">  search.send_keys(addr)</span><br><span class="line">  browser.find_element_by_xpath(<span class="string">&quot;/html/body/form/div[10]/div[2]/img[2]&quot;</span>).click()  </span><br><span class="line">  iframe = browser.find_element_by_class_name(<span class="string">&quot;winfoIframe&quot;</span>)  </span><br><span class="line">  browser.switch_to.frame(iframe)                              </span><br><span class="line">  co_btn = browser.find_element_by_xpath(<span class="string">&quot;/html/body/form/div[4]/table/tbody/tr[3]/td/table/tbody/tr/td[2]&quot;</span>)</span><br><span class="line">  co_btn.click()</span><br><span class="line">  page_results = browser.find_element_by_xpath(<span class="string">&quot;/html/body/form/div[5]/table/tbody/tr[2]/td&quot;</span>)   </span><br><span class="line">  coor = page_results.text.strip().split(<span class="string">&quot; &quot;</span>)</span><br><span class="line">  lat = coor[-<span class="number">1</span>].split(<span class="string">&quot;：&quot;</span>)[-<span class="number">1</span>]         </span><br><span class="line">  lng = coor[<span class="number">0</span>].split(<span class="string">&quot;：&quot;</span>)[-<span class="number">1</span>]</span><br><span class="line">  browser.quit()                                <span class="comment">#關閉網頁</span></span><br><span class="line">  <span class="keyword">return</span> lat, lng</span><br></pre></td></tr></table></figure>

<p>到這邊地址轉經緯度功能差不多做完了，剩下就是一些程式上的優化</p>
<p>當然如果是少量資料這樣跑肯定是沒什麼問題，大量跑起來就會有一些問題出現了</p>
<h3 id="網頁爬蟲多次後讀取超時"><a href="#網頁爬蟲多次後讀取超時" class="headerlink" title="網頁爬蟲多次後讀取超時"></a>網頁爬蟲多次後讀取超時</h3><p><strong>連續開啟網頁多次後，網頁元素還沒有載入完成程式就要存取就會出錯</strong></p>
<p>因為抓不到元素又沒寫例外處理，程式就會直接中斷執行，此時可以加上</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium.webdriver.support.ui <span class="keyword">import</span> WebDriverWait</span><br><span class="line"></span><br><span class="line">===與前面相同===</span><br><span class="line">wait = WebDriverWait(browser,<span class="number">60</span>)                     </span><br><span class="line">iframe = wait.until(<span class="keyword">lambda</span> browser: browser.find_element_by_class_name(<span class="string">&quot;winfoIframe&quot;</span>))  </span><br></pre></td></tr></table></figure>
<p>這段程式碼意思是在存取時等待一段時間存取，存取到才會給網頁元素，沒有就會進入TimeoutException</p>
<p>我的情況是在抓顯示目標地址iframe時候會出現，所以我選擇延後抓取時間，若60秒沒抓到就進例外處理</p>
<p>Python例外若沒進行處理會強制中止程式執行，處理例外可以這樣寫</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium.common.exceptions <span class="keyword">import</span> TimeoutException</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">	browser.get(targetUrl)</span><br><span class="line">	===與前面相同===</span><br><span class="line"><span class="keyword">except</span> TimeoutException <span class="keyword">as</span> t:</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&quot;這次讀取超時&quot;</span>)</span><br><span class="line">    browser.quit()</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>,<span class="number">1</span></span><br></pre></td></tr></table></figure>
<p>讓函式回傳(1,1)表示出現例外情況，讓程式可以自己判斷接下來的操作而不是被強制中止</p>
<h3 id="網頁爬蟲多次後被偵測成機器人"><a href="#網頁爬蟲多次後被偵測成機器人" class="headerlink" title="網頁爬蟲多次後被偵測成機器人"></a>網頁爬蟲多次後被偵測成機器人</h3><p><strong>連續開啟網頁多次後，目標網頁暫時封鎖你的存取使程式無法取得資料</strong></p>
<p>一般來說網頁都會做反爬蟲的機制，因為大量的爬蟲會消耗伺服器的資源，會導致一般用戶的體驗受影響，爬蟲還是要適可而止啊…</p>
<p><strong>一旦被判定成機器人，就直接鎖存取的IP了，此時要再度存取只能換IP來規避封鎖</strong></p>
<p>當然這部分也需要例外處理不然程式照樣中止給你看，寫法可參考</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium.common.exceptions <span class="keyword">import</span> UnexpectedAlertPresentException</span><br><span class="line"></span><br><span class="line">===與前面相同===</span><br><span class="line"><span class="keyword">except</span> UnexpectedAlertPresentException <span class="keyword">as</span> bot:         </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;被偵測成機器人囉!&quot;</span>)</span><br><span class="line">    browser.quit()</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>,<span class="number">1</span></span><br></pre></td></tr></table></figure>
<h4 id="降低被偵測成機器人的機率"><a href="#降低被偵測成機器人的機率" class="headerlink" title="降低被偵測成機器人的機率"></a>降低被偵測成機器人的機率</h4><p>前面也有提到更換請求的用戶代理讓網頁伺服器誤判請求來源，有些情況反而會使原本能抓到的元素抓不到要注意(瀏覽器版本過於老舊某些元件可能不支援或不存在等)</p>
<p>再來就是在完成每次請求資料的時間點讓程式休息一下，python內建語法可使用(單位：秒)</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">time.sleep(<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<p>最好加上隨機變化的休息時間來降低被偵測的機率</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">rest= random.randint(<span class="number">1</span>,<span class="number">5</span>)</span><br><span class="line">time.sleep(rest)</span><br></pre></td></tr></table></figure>
<h2 id="讀取CSV檔案"><a href="#讀取CSV檔案" class="headerlink" title="讀取CSV檔案"></a>讀取CSV檔案</h2><p>這邊提一下我在做這功能時用到的模組，以常見的CSV檔案為例</p>
<p>假設我今天要處理的CSV檔案內容是</p>
<pre><code>楊文昌診所,高雄市林園區東林西路281號
澄品牙醫診所,高雄市林園區林園北路384號
大統內兒科診所,高雄市大寮區鳳林四路五十六號
</code></pre>
<p>以上資料是我從政府開放性平台取得，原生檔案並沒有經緯度存在</p>
<p>那我就能讀取檔案後將內容存在變數 datas 中</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> csv</span><br><span class="line"></span><br><span class="line">file = <span class="string">&#x27;要處理的檔案名稱.csv&#x27;</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(file,encoding=<span class="string">&quot;utf-8&quot;</span>) <span class="keyword">as</span> csvFile:  <span class="comment"># with open()只在函式內部讀取，離開函式會關檔</span></span><br><span class="line">    csvReader = csv.reader(csvFile)</span><br><span class="line">    datas = <span class="built_in">list</span>(csvReader)</span><br></pre></td></tr></table></figure>


<h2 id="輸出CSV檔案"><a href="#輸出CSV檔案" class="headerlink" title="輸出CSV檔案"></a>輸出CSV檔案</h2><p>將上面取得的經緯度依需求整理成特定格式CSV檔案並儲存輸出到電腦上</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> csv</span><br><span class="line"></span><br><span class="line">outputFile = <span class="string">&#x27;要輸出的檔案名稱.csv&#x27;</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(outputFile, <span class="string">&#x27;w&#x27;</span>, newline=<span class="string">&#x27;&#x27;</span>,encoding=<span class="string">&quot;utf-8&quot;</span>) <span class="keyword">as</span> csvWrite: </span><br><span class="line">    csvWriter = csv.writer(csvWrite)</span><br><span class="line">    csvWriter.writerow([<span class="string">&#x27;名稱&#x27;</span>, <span class="string">&#x27;地址&#x27;</span>, <span class="string">&#x27;lat&#x27;</span>,<span class="string">&#x27;lng&#x27;</span>])  <span class="comment">#寫入第一行</span></span><br><span class="line">    <span class="keyword">for</span> result <span class="keyword">in</span> datas:</span><br><span class="line">      location = get_coordinate(result[<span class="number">1</span>])</span><br><span class="line">      result.extend([location[<span class="number">0</span>],location[<span class="number">1</span>]])</span><br><span class="line">      <span class="built_in">print</span> (result)                                  <span class="comment">#在終端機印出結果</span></span><br><span class="line">      csvWriter.writerow(result)        			  <span class="comment">#寫入檔案    </span></span><br></pre></td></tr></table></figure>
<p>這邊注意with open的第二個參數</p>
<ul>
<li>‘w’：是每次寫入都重頭開始，若沒找不到檔案會自己產生一個</li>
<li>‘a’：寫入是從檔案的最後一行開始，不會自己產生檔案</li>
</ul>
<p>以上便是我透過網頁爬蟲去將地址轉成經緯度的python程式碼</p>
<p>當然這方法懂之後所有網頁都能適用，網頁反爬蟲的機制也不只被ip封鎖那麼簡單了</p>
<p>像是輸入驗證碼或是圖像驗證之類的在現代網頁反爬蟲也不少見就是，當然也有破解法又是別的故事了…</p>
<p>要成為一名精通網頁爬蟲的工程師之路是很廣闊的啊 ~</p>
<h1 id="參考資料"><a href="#參考資料" class="headerlink" title="參考資料"></a>參考資料</h1><ul>
<li><p><a href="https://ithelp.ithome.com.tw/articles/10225429">iT邦幫忙鐵人賽-【Day 21】反反爬蟲 (2/2)</a></p>
</li>
<li><p><a href="https://selflearningsuccess.com/pythonstring/#%E4%BD%BF%E7%94%A8_Str_%E5%87%BD%E5%BC%8F%E4%BE%86%E5%BB%BA%E7%AB%8B%E5%AD%97%E4%B8%B2">Python字串基礎與20種常見操作</a></p>
</li>
</ul>
]]></content>
      <categories>
        <category>技術筆記</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>網頁爬蟲</tag>
        <tag>地址轉經緯度</tag>
      </tags>
  </entry>
  <entry>
    <title>Raspbain實作筆記</title>
    <url>/2021/12/24/Raspbain%E5%AF%A6%E4%BD%9C%E7%AD%86%E8%A8%98/</url>
    <content><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>簡單記錄一下如何從空機到能正常使用的步驟 </p>
<p>操作基本上使用 Windows作業系統</p>
<h1 id="初次安裝"><a href="#初次安裝" class="headerlink" title="初次安裝"></a>初次安裝</h1><p><strong>在開始安裝前請準備一台『讀卡機』</strong></p>
<span id="more"></span>

<ol>
<li><a href="https://www.raspberrypi.org/downloads/raspbian/">Raspbain官網</a>   </li>
</ol>
<p>→ 下載「Raspbain Buster with desktop」的ZIP檔，作業系統</p>
<ol start="2">
<li><a href="https://www.balena.io/etcher/">balenaEtcher</a></li>
</ol>
<p>→ 下載並安裝，燒錄程式</p>
<ol start="3">
<li><a href="https://mobaxterm.mobatek.net/">Mobaxterm</a></li>
</ol>
<p>→ 下載並安裝，遠端操作</p>
<ol start="4">
<li><a href="https://angryip.org/">angryip</a></li>
</ol>
<p>→ 下載並安裝，掃描樹梅派IP </p>
<h2 id="第一步：燒錄"><a href="#第一步：燒錄" class="headerlink" title="第一步：燒錄"></a>第一步：燒錄</h2><p>將SD卡插入讀卡機並與電腦連接，開啟『balenaEtcher』</p>
<p> <img src="https://i.imgur.com/CW809w5.png" alt="balenaEtcher"></p>
<ol>
<li><p>選擇「Raspbain Buster with desktop」的ZIP檔</p>
</li>
<li><p>選擇「SD卡的磁碟」</p>
</li>
<li><p>等待進度條跑完</p>
</li>
</ol>
<h2 id="第二步：設定網路連線"><a href="#第二步：設定網路連線" class="headerlink" title="第二步：設定網路連線"></a>第二步：設定網路連線</h2><ol>
<li>在SD卡的boot磁區建立檔名為「ssh」的空檔(不要有副檔名)，開啟ssh功能**(預設為關)**</li>
</ol>
<img src="https://i.imgur.com/1p04Q2j.png" alt="ssh" style="zoom:90%;" />

<ol start="2">
<li>在SD卡的boot磁區建立檔名為「<strong>wpa_supplicant.conf</strong>」的檔案</li>
</ol>
<p>  建議<strong>不要用記事本開</strong>，可用 <strong>Nodepad++、Sublime</strong> 等開啟</p>
<p>→ 檔案內容如下：<br><strong>(區分大小寫，失敗返回第一步)</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ctrl_interface=DIR=/var/run/wpa_supplicant GROUP=netdev</span><br><span class="line"></span><br><span class="line">update_config=1</span><br><span class="line"></span><br><span class="line">country=TW</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">network=&#123;</span><br><span class="line"></span><br><span class="line">  ssid=&quot;SSID名稱&quot;</span><br><span class="line"></span><br><span class="line">  psk=&quot;密碼&quot;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>network 部分 為 要連線的WiFi 帳密</p>
<h2 id="第三步：開機"><a href="#第三步：開機" class="headerlink" title="第三步：開機"></a>第三步：開機</h2><ol>
<li><p>樹梅派插上SD卡並開機</p>
<p>→ 注意樹梅派的 燈號是否閃爍</p>
</li>
</ol>
<ul>
<li><p>開機閃爍，SD卡正在讀取，正常</p>
</li>
<li><p>開機不閃爍，樹梅派、SD卡、作業系統三者之一損毀</p>
</li>
</ul>
<h2 id="第四步：找到樹梅派-IP"><a href="#第四步：找到樹梅派-IP" class="headerlink" title="第四步：找到樹梅派 IP"></a>第四步：找到樹梅派 IP</h2><p>在電腦上使用「angryip」搜尋IP</p>
<p><img src="https://i.imgur.com/vgNd5qL.png" alt="ipscan"></p>
<p><strong>預設名稱為「raspberrypi.local」</strong></p>
<p><code>無線網路：樹梅派與電腦需同一網段</code></p>
<p><code>有線網路：需要路由器與網路線手動將電腦與樹梅派置於同一網段</code></p>
<h2 id="第五步：使用網路連線"><a href="#第五步：使用網路連線" class="headerlink" title="第五步：使用網路連線"></a>第五步：使用網路連線</h2><p>SSH：使用 mobaxterm</p>
<p>點選Sessions &gt; New session &gt; SSH </p>
<p><img src="https://i.imgur.com/hAxVTh4.png" alt="MobaXterm"></p>
<p>設定如上圖預設帳號：pi  ，點選OK進入輸入密碼頁面</p>
<p>預設密碼：raspberry  便可成功登入</p>
<h2 id="第六步：系統設定"><a href="#第六步：系統設定" class="headerlink" title="第六步：系統設定"></a>第六步：系統設定</h2><p>編輯檔案推薦使用 nano </p>
<h3 id="主機設定"><a href="#主機設定" class="headerlink" title="主機設定"></a>主機設定</h3><p><code>sudo raspi - config</code></p>
<p>→ 修改密碼 (第一個)</p>
<p>→ 修改樹梅派hostname (第二個) </p>
<p>→ 修改時區 (第四個) </p>
<p>→ 修改WIFI國家( TW ) </p>
<h3 id="WiFi設定"><a href="#WiFi設定" class="headerlink" title="WiFi設定"></a>WiFi設定</h3><p><code>sudo nano /etc/rc.local</code>  </p>
<p>→ 檔案最後加上( 關閉wifi睡眠 )</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">iwconfig wlan0 power off </span><br><span class="line"></span><br><span class="line">iw dev wlan0 set power_save off</span><br></pre></td></tr></table></figure>

<p>儲存後離開，並使用 ifconfig  確認wlan0是否開啟</p>
<h3 id="遠端桌面"><a href="#遠端桌面" class="headerlink" title="遠端桌面"></a>遠端桌面</h3><p><code>sudo apt-get install xrdp</code></p>
<p>→ 在搜尋中輸入mstsc 找到遠端桌面連線並輸入樹梅派 IP 連線</p>
<p>→ 輸入樹梅派帳號密碼存取</p>
<h3 id="安裝vim格式設定"><a href="#安裝vim格式設定" class="headerlink" title="安裝vim格式設定"></a>安裝vim格式設定</h3><p><code>sudo apt-get install vim</code></p>
<p><code>sudo nano /etc/vim/vimrc.local</code></p>
<p> 檔案最後輸入以下內容(格式設定)：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">set tabstop=4 </span><br><span class="line"></span><br><span class="line">set expandtab </span><br><span class="line"></span><br><span class="line">set shiftwidth=4</span><br><span class="line"></span><br><span class="line">set nu</span><br></pre></td></tr></table></figure>
<h3 id="進行系統更新"><a href="#進行系統更新" class="headerlink" title="進行系統更新"></a>進行系統更新</h3><p> <code>sudo apt-get update</code></p>
<p>→ 更新來源清單</p>
<p><code>sudo apt-get-upgrade</code></p>
<p>→ 更新軟體</p>
<h3 id="重開機與關機指令"><a href="#重開機與關機指令" class="headerlink" title="重開機與關機指令"></a>重開機與關機指令</h3><ul>
<li>重開機</li>
</ul>
<p><code>sudo shutdown –r now</code></p>
<p><code>sudo reboot</code></p>
<ul>
<li>關機</li>
</ul>
<p><code>sudo shutdown –h now</code></p>
<h1 id="樹梅派接腳-GPIO"><a href="#樹梅派接腳-GPIO" class="headerlink" title="樹梅派接腳 (GPIO)"></a>樹梅派接腳 (GPIO)</h1><p><strong>注意接腳，隨意接觸可能導致樹梅派燒毀</strong></p>
<p><img src="https://i.imgur.com/3Mfd3ce.png" alt="rasp_1"></p>
<p>在程式選用接腳時不要與現有接腳衝突  </p>
<p><img src="https://i.imgur.com/mcUFttK.png" alt="rasp_2"></p>
]]></content>
      <categories>
        <category>技術筆記</category>
      </categories>
      <tags>
        <tag>Raspbain</tag>
      </tags>
  </entry>
  <entry>
    <title>來用Apache架設簡單WebServer吧</title>
    <url>/2021/12/29/%E4%BE%86%E4%BD%BF%E7%94%A8Apache%E6%9E%B6%E8%A8%AD%E4%B8%80%E5%80%8B%E7%B0%A1%E5%96%AE%EF%BC%B7ebServer%E5%90%A7/</url>
    <content><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p><img src="https://i.imgur.com/KUO20Hj.png"></p>
<p>本文安裝環境為 <strong>Ubuntu16.04</strong></p>
<p>提供給初學想要用 Apache 架站的人做參考</p>
<p>會由安裝到 Apache 的細部設定依序說明</p>
<span id="more"></span>

<h1 id="安裝Apache"><a href="#安裝Apache" class="headerlink" title="安裝Apache"></a>安裝Apache</h1><ol>
<li>安裝套件</li>
</ol>
<p>​    <code>sudo apt-get install apache2</code></p>
<ol start="2">
<li>確認安裝完成後啟動服務(兩個指令都行)</li>
</ol>
<p>​    <code>sudo systemctl start apache2</code></p>
<p>​    <code>sudo systemctl start apache2</code></p>
<p>啟用後可以用以下兩個指令查看運作狀態</p>
<p><code>sudo service apache2 status</code></p>
<p><code>sudo systemctl status apache2</code>  </p>
<h1 id="細部設定"><a href="#細部設定" class="headerlink" title="細部設定"></a>細部設定</h1><h2 id="個人首頁設定"><a href="#個人首頁設定" class="headerlink" title="個人首頁設定"></a>個人首頁設定</h2><ol>
<li>啟用個人首頁</li>
</ol>
<p>​    <code>sudo a2enmod userdir</code></p>
<ol start="2">
<li><p>新增個人首頁的設定檔</p>
<p><code>sudo nano /etc/apache2/mods-available/userdir.conf</code></p>
</li>
<li><p>確認防火牆開啟</p>
<p><code>sudo iptables -t filter -L –n</code></p>
</li>
<li><p>重啟 Apache 服務</p>
<p><code>sudo systemctl restart apache2.service</code></p>
</li>
</ol>
<p>這時候在自己帳號的資料夾底下( 通常會是 […/使用者帳號/home/] )</p>
<p>建立 public_html 資料夾</p>
<p><code>mkdir public_html</code></p>
<p>並放上網頁檔案在網址列打上</p>
<p><strong>電腦的ip  / ~使用者名稱 / 檔案名稱</strong></p>
<p>就能看到放上去的網頁了</p>
<h2 id="放置網頁檔案的目錄"><a href="#放置網頁檔案的目錄" class="headerlink" title="放置網頁檔案的目錄"></a>放置網頁檔案的目錄</h2><p>請更改以下檔案</p>
<p><code>sudo nano /etc/apache2/sites-enabled/000-default</code></p>
<p>找到 DocumentRoot 後面改成要改的目錄位置</p>
<h2 id="網頁檔案名稱的設定"><a href="#網頁檔案名稱的設定" class="headerlink" title="網頁檔案名稱的設定"></a>網頁檔案名稱的設定</h2><p>請更改以下檔案</p>
<p><code>sudo nano /etc/apache2/mods-available/dir.conf</code></p>
<p>找到  DirectoryIndex  後面改成要改的檔案名稱 </p>
<h2 id="可能會用到的指令"><a href="#可能會用到的指令" class="headerlink" title="可能會用到的指令"></a>可能會用到的指令</h2><ul>
<li>查看 Apache 版本</li>
</ul>
<p>​        <code>apache2 -v</code></p>
<h3 id="系統時區"><a href="#系統時區" class="headerlink" title="系統時區"></a>系統時區</h3><ul>
<li><p>查看時區</p>
<p><code>timedatectl</code></p>
</li>
<li><p>設定時區</p>
<p><code>sudo timedatectl set-timezone Asia/Taipei </code></p>
</li>
<li><p>查看能設定時區的地區</p>
<p><code>timedatectl list-timezones</code></p>
</li>
</ul>
<h3 id="內部防火牆"><a href="#內部防火牆" class="headerlink" title="內部防火牆"></a>內部防火牆</h3><ul>
<li><p>啟用或停用狀態</p>
<p><code>sudo ufw enable/disable</code></p>
</li>
<li><p>啟用日誌</p>
<p><code>sudo ufw logging on</code></p>
</li>
<li><p>查看狀態及規則</p>
<p><code>sudo ufw status</code></p>
<p><code>sudo ufw status verbose</code></p>
<p><code>sudo ufw status numbered #以數字排列目前防火牆規則</code></p>
<p><code>sudo ufw delete 3 #刪除剛剛查看的第三條防火牆規則</code></p>
<p><code>sudo ufw reset #清空防火牆所有已設置之規則</code></p>
</li>
<li><p>查看需要開放的應用程式</p>
<p><code>sudo ufw app list</code> </p>
</li>
<li><p>查看應用程式開放資訊</p>
<p><code>sudo ufw app info “應用程式名稱”</code></p>
<p>Ex :</p>
<p>要開放 Apache 的通行請打</p>
<p><code>sudo ufw allow in &quot;Apache Full&quot;</code> </p>
</li>
</ul>
<h1 id="沒有實體機器的做法"><a href="#沒有實體機器的做法" class="headerlink" title="沒有實體機器的做法"></a>沒有實體機器的做法</h1><p>請去下載 <a href="https://www.virtualbox.org/wiki/Downloads">Virtualbox</a></p>
<p>裝好 <strong>Ｗindows作業系統</strong> 後</p>
<ol>
<li><p>開機前將網路介面卡設成 <strong>僅限主機的介面卡</strong></p>
</li>
<li><p>開機後使用 終端機指令 查看enp0s3(或其他)位址</p>
<p><code>ipconfig</code></p>
</li>
</ol>
<p>​        假設看到的ip為  <strong>192.168.56.102</strong></p>
<ol start="3">
<li><p>更改C:\Windows\System32\drivers\etc\hosts 檔案內容</p>
<p><strong>預設要先把User權限打開才能編輯</strong></p>
<p>更改的內容如下</p>
<p><img src="https://i.imgur.com/0DG9Vtg.png" alt="hosts內容"></p>
</li>
<li><p>在自己電腦瀏覽器輸入  <a href="http://192.168.56.102/">http://192.168.56.102/</a> 或 <a href="http://guestserver.com/">http://guestserver.com/</a> 就能看到首頁</p>
</li>
</ol>
<h2 id="設定-NAT-Host-only-網卡"><a href="#設定-NAT-Host-only-網卡" class="headerlink" title="設定 NAT + Host-only 網卡"></a>設定 NAT + Host-only 網卡</h2><p>若虛擬機想要連上網路用 Host-only是不行的 </p>
<p>需要設定第二張網卡 NAT</p>
<ul>
<li>查看網卡名稱</li>
</ul>
<p>​        <code>ip link</code></p>
<ul>
<li>更改網路設定檔</li>
</ul>
<p>​        <code>sudo nano /etc/network/interfaces</code></p>
<p>​        更改內容如圖所示</p>
<p><img src="https://i.imgur.com/UcHZXIi.png" alt="interfaces內容"></p>
<ul>
<li><p>啟用寫好的網路介面並重啟網路</p>
<p><code>sudo ifup enp0s8</code></p>
<p><code>sudo /etc/init.d/networking restart</code></p>
</li>
</ul>
]]></content>
      <categories>
        <category>技術筆記</category>
      </categories>
      <tags>
        <tag>Apache</tag>
        <tag>ＷebServer</tag>
      </tags>
  </entry>
  <entry>
    <title>155. Min Stack javascript解題</title>
    <url>/2021/11/08/155-Min-Stack-javascript/</url>
    <content><![CDATA[<h1 id="題目說明"><a href="#題目說明" class="headerlink" title="題目說明"></a>題目說明</h1><p>Design a stack that supports push, pop, top, and retrieving the minimum element in constant time.</p>
<p>Implement the MinStack class:</p>
<ul>
<li>MinStack() initializes the stack object.</li>
<li>void push(int val) pushes the element val onto the stack.</li>
<li>void pop() removes the element on the top of the stack.</li>
<li>int top() gets the top element of the stack.</li>
<li>int getMin() retrieves the minimum element in the stack.</li>
</ul>
<span id="more"></span>

<p>Input / Output(測試資料輸入/輸出):</p>
<pre><code>參考leetcode
</code></pre>
<p>Explanation(使用範例):</p>
<pre><code>MinStack minStack = new MinStack();
minStack.push(-2);
minStack.push(0);
minStack.push(-3);
minStack.getMin(); // return -3
minStack.pop();
minStack.top();    // return 0
minStack.getMin(); // return -2
</code></pre>
<p>Constraints(參數限制):</p>
<ul>
<li>-231 &lt;= val &lt;= 231 - 1</li>
<li>Methods pop, top and getMin operations will always be called on non-empty stacks.</li>
<li>At most 3 * 104 calls will be made to push, pop, top, and getMin.</li>
</ul>
<h1 id="解題思路"><a href="#解題思路" class="headerlink" title="解題思路"></a>解題思路</h1><p>在Leetcode算Easy的題目，複習Stack堆疊先進後出的觀念，以下以實作上較特別的功能函數做說明</p>
<h2 id="push"><a href="#push" class="headerlink" title="push()"></a>push()</h2><p>每次推之前都檢查推的值是否比 min 存的值還小，有就存進去</p>
<p>所以 min 最底層永遠是最小值</p>
<h2 id="pop"><a href="#pop" class="headerlink" title="pop()"></a>pop()</h2><p>每次移除最後一個值之前都檢查移除的值是否與 min 存的值相等，有就順便移除掉</p>
<p>最後一個值 =&gt; 最早 push 進堆疊的數值 =&gt;  維持 min 裡面最後一項永遠最小</p>
<h1 id="程式碼"><a href="#程式碼" class="headerlink" title="程式碼"></a>程式碼</h1><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> MinStack = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;  </span><br><span class="line">    <span class="built_in">this</span>.stack = [];</span><br><span class="line">    <span class="built_in">this</span>.min = [];</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">MinStack.prototype.push = <span class="function"><span class="keyword">function</span>(<span class="params">val</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">this</span>.min.length === <span class="number">0</span> || val &lt;= <span class="built_in">this</span>.getMin())&#123;</span><br><span class="line">        <span class="built_in">this</span>.min.push(val);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">this</span>.stack.push(val);</span><br><span class="line">&#125;; </span><br><span class="line"></span><br><span class="line">MinStack.prototype.pop = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">     <span class="keyword">if</span>(<span class="built_in">this</span>.getMin()  === <span class="built_in">this</span>.top())&#123;</span><br><span class="line">        <span class="built_in">this</span>.min.pop();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">this</span>.stack.pop();</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">MinStack.prototype.top = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span>  <span class="built_in">this</span>.stack[ <span class="built_in">this</span>.stack.length-<span class="number">1</span>];</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">MinStack.prototype.getMin = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">     <span class="keyword">return</span>  <span class="built_in">this</span>.min[ <span class="built_in">this</span>.min.length-<span class="number">1</span>];</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>解題紀錄</category>
      </categories>
      <tags>
        <tag>LeetCode</tag>
      </tags>
  </entry>
  <entry>
    <title>記憶翻牌JAVA小遊戲</title>
    <url>/2021/12/14/%E8%A8%98%E6%86%B6%E7%BF%BB%E7%89%8CJAVA%E5%B0%8F%E9%81%8A%E6%88%B2/</url>
    <content><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>大學時期做的JAVA小遊戲</p>
<p>圖片是從當時喜歡的遊戲抓的</p>
<p><del>順便推廣不是很讚嗎</del></p>
<h1 id="遊戲概念"><a href="#遊戲概念" class="headerlink" title="遊戲概念"></a>遊戲概念</h1><p>在每場遊戲開始會給予時間讓玩家看清每張圖片的位置<br>盡可能在最短時間內將對應的圖片湊齊，即可通關</p>
<span id="more"></span>

<h1 id="遊戲規則"><a href="#遊戲規則" class="headerlink" title="遊戲規則"></a>遊戲規則</h1><ol>
<li>全部圖片共有36張圖，遊戲關卡有3關，有分一般和極限模式</li>
<li>每局遊戲開始前會先讓玩家看「現在關卡 = 觀看秒數」記圖片位置</li>
<li>翻錯圖片時，錯誤圖片會停留 1 秒讓玩家看</li>
<li>猜對得 1000分，猜錯扣 100分</li>
</ol>
<h1 id="遊戲介面"><a href="#遊戲介面" class="headerlink" title="遊戲介面"></a>遊戲介面</h1><p>剛打開會像這樣子</p>
<p><img src="/images/Java_game_1.png"></p>
<p>之後關卡圖片數量會增加，通關後會出現這個</p>
<p><img src="/images/Java_game_2.png"></p>
<p>最後關卡會長這樣子</p>
<p><img src="/images/Java_game_3.png"></p>
<p>還有極限模式可以選</p>
<p><img src="/images/Java_game_mode_3.png"></p>
<h1 id="程式碼"><a href="#程式碼" class="headerlink" title="程式碼"></a>程式碼</h1><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.awt.*;</span><br><span class="line"><span class="keyword">import</span> javax.swing.*;</span><br><span class="line"><span class="keyword">import</span> java.awt.event.*;</span><br><span class="line"><span class="keyword">import</span> sun.audio.*; <span class="comment">//import the sun.audio package</span></span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.applet.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">memorycard</span> <span class="keyword">extends</span> <span class="title">JFrame</span> <span class="keyword">implements</span> <span class="title">Runnable</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">     </span><br><span class="line">   </span><br><span class="line">        <span class="keyword">private</span> ButtonHandler baf = <span class="keyword">new</span> ButtonHandler();                        <span class="comment">//功能表單事件</span></span><br><span class="line">        <span class="keyword">private</span> JMenuBar jmb;</span><br><span class="line">       </span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">int</span> row = <span class="number">4</span> ;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">int</span> col = <span class="number">4</span>;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">int</span> LK_SEC = <span class="number">1</span>;                                                 <span class="comment">//設定一開始可看幾秒</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">int</span> add = <span class="number">1000</span>, dec = <span class="number">100</span>;                                      <span class="comment">//得分1000 扣分100</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">int</span> LimPoint;                                                   <span class="comment">//極限模式目標分數與秒數</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">long</span> LimSec;</span><br><span class="line">        </span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">int</span> sec = <span class="number">1</span>;                                                    <span class="comment">//設定翻開的牌不相同會蓋回去的秒速</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">int</span> imgH = <span class="number">0</span>,imgW =<span class="number">0</span>,score = <span class="number">0</span>;                                 <span class="comment">//imgH圖高，imgW圖寬，score分數</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">int</span> count = <span class="number">0</span>;                                                  <span class="comment">//正確的對數</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">long</span> startTime =<span class="number">0</span>;                                              <span class="comment">//遊戲開始的計時 </span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">int</span> level ;                                                     <span class="comment">//關卡等級</span></span><br><span class="line">	</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> JMenu game = <span class="keyword">new</span> JMenu(<span class="string">&quot;遊戲設定&quot;</span>),other = <span class="keyword">new</span> JMenu(<span class="string">&quot;其他資訊&quot;</span>);</span><br><span class="line">        <span class="keyword">private</span> JTextField usedtime;                                            <span class="comment">//遊戲經過時間</span></span><br><span class="line">        <span class="keyword">private</span> JTextField stage ;                                              <span class="comment">//遊戲關卡數</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> JMenuItem [] gm = <span class="keyword">new</span> JMenuItem[<span class="number">5</span>];                             <span class="comment">//遊戲設定選項格</span></span><br><span class="line">        <span class="keyword">private</span> JMenuItem [] oth = <span class="keyword">new</span> JMenuItem[<span class="number">2</span>];                            <span class="comment">//其他選項格</span></span><br><span class="line">     </span><br><span class="line">        <span class="keyword">private</span> JPanel jpl;</span><br><span class="line">        <span class="keyword">private</span> JLabel jl = <span class="keyword">new</span> JLabel(<span class="string">&quot;分數 : 0&quot;</span>);</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">int</span> [] m;                                                       <span class="comment">//存放每次重新玩的圖片順序</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">int</span> [] twoImg = &#123;-<span class="number">1</span>,-<span class="number">1</span>&#125;;                                        <span class="comment">//記錄目前翻開的兩張圖編號</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">int</span> [] btnIndex = &#123;-<span class="number">1</span>,-<span class="number">1</span>&#125;;                                      <span class="comment">//記錄被翻開兩張圖的按鈕位置</span></span><br><span class="line">        <span class="keyword">private</span> JButton [] imgbtn;                                              <span class="comment">//圖片按鈕</span></span><br><span class="line">        <span class="keyword">private</span> ImageIcon []img ;                                               <span class="comment">//存放圖物件</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">boolean</span> [] imgShow;                                             <span class="comment">//記錄已配對成功過的圖</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">boolean</span> [] btnDown;                                             <span class="comment">//記錄被按過的按鈕</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">boolean</span> isChange = <span class="keyword">false</span>;                                       <span class="comment">//用來確認是否切換存放兩張圖順序</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">boolean</span> isStart = <span class="keyword">false</span>;                                        <span class="comment">//確認是否開始</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">boolean</span> Limplay = <span class="keyword">false</span>;                                        <span class="comment">//確認是否極限模式</span></span><br><span class="line">                               </span><br><span class="line">   </span><br><span class="line">       </span><br><span class="line">      </span><br><span class="line">         <span class="function"><span class="keyword">public</span> <span class="title">memorycard</span><span class="params">(<span class="keyword">int</span> mul,<span class="keyword">int</span> L)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">                <span class="keyword">super</span>(<span class="string">&quot;記憶翻牌&quot;</span>);</span><br><span class="line">                level = L;</span><br><span class="line">                LK_SEC = level;</span><br><span class="line">                <span class="keyword">if</span>(L==<span class="number">1</span>)</span><br><span class="line">                     row = col = <span class="number">2</span>;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span>(L == <span class="number">2</span>)</span><br><span class="line">                    row = col = <span class="number">4</span>;</span><br><span class="line">                 <span class="keyword">else</span> <span class="keyword">if</span>(L == <span class="number">3</span>)</span><br><span class="line">                    row = col = <span class="number">6</span>;</span><br><span class="line">                </span><br><span class="line">                LimPoint = (row*col*<span class="number">500</span>);</span><br><span class="line">                LimSec = (row*col/<span class="number">2</span>)+<span class="number">2</span>;</span><br><span class="line">                <span class="keyword">if</span>(mul == <span class="number">1</span>)</span><br><span class="line">                     Limplay=<span class="keyword">true</span>;</span><br><span class="line">                </span><br><span class="line">                </span><br><span class="line">              </span><br><span class="line">                imgbtn = <span class="keyword">new</span> JButton[row * col];</span><br><span class="line">                img = <span class="keyword">new</span> ImageIcon[row * col];</span><br><span class="line">                imgShow = <span class="keyword">new</span> <span class="keyword">boolean</span>[row*col/<span class="number">2</span>];</span><br><span class="line">                btnDown = <span class="keyword">new</span> <span class="keyword">boolean</span> [row*col];</span><br><span class="line"></span><br><span class="line">                jpl = <span class="keyword">new</span> JPanel(<span class="keyword">new</span> GridLayout(row,col,<span class="number">0</span>,<span class="number">0</span>));</span><br><span class="line">                Container c = getContentPane(); </span><br><span class="line">                c = <span class="keyword">this</span>.getContentPane();</span><br><span class="line">                jmb = <span class="keyword">new</span> JMenuBar();</span><br><span class="line">                <span class="keyword">this</span>.setJMenuBar(jmb);                                          <span class="comment">//加入工具列</span></span><br><span class="line">                usedtime = <span class="keyword">new</span> JTextField();                                    <span class="comment">//遊戲時間</span></span><br><span class="line">                usedtime.setEditable(<span class="keyword">false</span>);</span><br><span class="line">                stage = <span class="keyword">new</span> JTextField(<span class="string">&quot;Round &quot;</span>+ level +<span class="string">&quot;：&quot;</span>);                  <span class="comment">//關卡名稱</span></span><br><span class="line">                stage.setEditable(<span class="keyword">false</span>);</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">            </span><br><span class="line">                </span><br><span class="line">              </span><br><span class="line">                setLocation(<span class="number">200</span>,<span class="number">50</span>); </span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; img.length; i++)                             <span class="comment">//初始化所有按鈕上的圖，預設為不可以按</span></span><br><span class="line">                &#123;</span><br><span class="line">                 img[i] = <span class="keyword">new</span> ImageIcon(getClass().getResource(<span class="string">&quot;images/p0.jpg&quot;</span>));</span><br><span class="line">                 imgbtn[i] = <span class="keyword">new</span> JButton(img[i]);</span><br><span class="line">                 imgbtn[i].addActionListener(baf);</span><br><span class="line">                 imgbtn[i].setEnabled(<span class="keyword">false</span>);</span><br><span class="line">                 jpl.add(imgbtn[i]);</span><br><span class="line">                 jpl.add(jl);</span><br><span class="line">                &#125;</span><br><span class="line">              </span><br><span class="line">                c.add(jpl,BorderLayout.CENTER);</span><br><span class="line">                c.add(jl,BorderLayout.SOUTH);                                  <span class="comment">//將分數label放到最下面</span></span><br><span class="line">                c.add(stage,BorderLayout.NORTH);</span><br><span class="line">                </span><br><span class="line">                <span class="comment">//遊戲設定的選擇項目</span></span><br><span class="line">                jmb.add(game);</span><br><span class="line">                gm[<span class="number">0</span>] = <span class="keyword">new</span> JMenuItem(<span class="string">&quot;開始遊戲&quot;</span>);</span><br><span class="line">                gm[<span class="number">1</span>] = <span class="keyword">new</span> JMenuItem(<span class="string">&quot;重新遊戲&quot;</span>);</span><br><span class="line">                gm[<span class="number">1</span>].setEnabled(<span class="keyword">false</span>);</span><br><span class="line">                gm[<span class="number">2</span>] = <span class="keyword">new</span> JMenuItem(<span class="string">&quot;離開遊戲&quot;</span>);</span><br><span class="line">                <span class="keyword">if</span>(level == <span class="number">3</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    gm[<span class="number">3</span>] = <span class="keyword">new</span> JMenuItem(<span class="string">&quot;前往下關&quot;</span>);</span><br><span class="line">                    gm[<span class="number">3</span>].setEnabled(<span class="keyword">false</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    gm[<span class="number">3</span>] = <span class="keyword">new</span> JMenuItem(<span class="string">&quot;前往下關&quot;</span>);</span><br><span class="line">                </span><br><span class="line">                gm[<span class="number">4</span>] = <span class="keyword">new</span> JMenuItem(<span class="string">&quot;極限模式&quot;</span>);</span><br><span class="line">                </span><br><span class="line">                game.add(gm[<span class="number">0</span>]);</span><br><span class="line">                game.add(gm[<span class="number">1</span>]);</span><br><span class="line">                game.add(gm[<span class="number">3</span>]);</span><br><span class="line">                <span class="keyword">if</span>(mul == <span class="number">0</span>)</span><br><span class="line">                     game.add(gm[<span class="number">4</span>]);   </span><br><span class="line">                game.addSeparator();                                            <span class="comment">//加入分隔線</span></span><br><span class="line">                game.add(gm[<span class="number">2</span>]);</span><br><span class="line">		</span><br><span class="line">                <span class="comment">//其他的選擇項目</span></span><br><span class="line">                jmb.add(other);</span><br><span class="line">                oth[<span class="number">0</span>] = <span class="keyword">new</span> JMenuItem(<span class="string">&quot;遊戲規則&quot;</span>);</span><br><span class="line">                oth[<span class="number">1</span>] = <span class="keyword">new</span> JMenuItem(<span class="string">&quot;關於作者&quot;</span>);</span><br><span class="line">            </span><br><span class="line">                other.add(oth[<span class="number">0</span>]);</span><br><span class="line">                other.add(oth[<span class="number">1</span>]);</span><br><span class="line">		</span><br><span class="line">                              </span><br><span class="line">                <span class="comment">//設定視窗</span></span><br><span class="line">             	imgH = img[<span class="number">0</span>].getIconHeight() * row;                            <span class="comment">//取得圖片高度</span></span><br><span class="line">           	imgW = img[<span class="number">0</span>].getIconWidth() * col;                                 <span class="comment">//取得圖片寬度</span></span><br><span class="line">                setSize(imgW,imgH);</span><br><span class="line">            </span><br><span class="line">                setResizable(<span class="keyword">false</span>);                                            <span class="comment">//視窗放大按鈕無效 </span></span><br><span class="line">                setVisible(<span class="keyword">true</span>);</span><br><span class="line">                setIconImage(<span class="keyword">new</span> ImageIcon(<span class="string">&quot;images/iconFrame.png&quot;</span>).getImage()); <span class="comment">//視窗預設圖示更改</span></span><br><span class="line">                setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);                <span class="comment">//關閉事件</span></span><br><span class="line">                        </span><br><span class="line">                <span class="comment">//註冊功能表單傾聽者</span></span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> m=<span class="number">0</span>;m&lt;gm.length;m++)</span><br><span class="line">                 gm[m].addActionListener(baf);</span><br><span class="line">                oth[<span class="number">0</span>].addActionListener(baf);</span><br><span class="line">                oth[<span class="number">1</span>].addActionListener(baf);           </span><br><span class="line">        &#125;</span><br><span class="line">       <span class="comment">//功能表單事件處理</span></span><br><span class="line">        <span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">ButtonHandler</span> <span class="keyword">implements</span>  <span class="title">ActionListener</span></span></span><br><span class="line"><span class="class">        </span>&#123;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">actionPerformed</span><span class="params">(ActionEvent ae)</span> 	<span class="comment">//按鈕事件</span></span></span><br><span class="line"><span class="function">            </span>&#123;</span><br><span class="line">             </span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; img.length; i++)</span><br><span class="line">                &#123;</span><br><span class="line">                 <span class="keyword">if</span>(ae.getSource() == imgbtn[i])</span><br><span class="line">                 &#123;</span><br><span class="line">                     checkIsRight(i,imgIndex(m[i]));</span><br><span class="line">                     <span class="keyword">break</span>;</span><br><span class="line">                 &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                 </span><br><span class="line">                <span class="keyword">if</span>(ae.getSource() == gm[<span class="number">0</span>])                                     <span class="comment">//開始遊戲</span></span><br><span class="line">                &#123;</span><br><span class="line">                 	replay(Limplay,level);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span>(ae.getSource() == gm[<span class="number">1</span>])                                <span class="comment">//重新遊戲</span></span><br><span class="line">                &#123;</span><br><span class="line">                 	replay(Limplay,level);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span>(ae.getSource() == gm[<span class="number">2</span>])                                <span class="comment">//結束遊戲</span></span><br><span class="line">                &#123;</span><br><span class="line">                 	System.exit(<span class="number">0</span>);</span><br><span class="line">                &#125;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span>(ae.getSource() == gm[<span class="number">3</span>])                                    <span class="comment">//前往下關</span></span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">if</span>(level  == <span class="number">3</span>)</span><br><span class="line">                        level = <span class="number">1</span>;</span><br><span class="line">                    <span class="keyword">else</span> <span class="keyword">if</span>(level &lt; <span class="number">3</span>)</span><br><span class="line">                        level++; </span><br><span class="line">                    <span class="keyword">new</span> memorycard(<span class="number">0</span>,level);      </span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span>(ae.getSource() == gm[<span class="number">4</span>])                                <span class="comment">//極限模式</span></span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">new</span> memorycard(<span class="number">1</span>,level);</span><br><span class="line">                    </span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span>(ae.getSource() == oth[<span class="number">0</span>])                               <span class="comment">//規則說明</span></span><br><span class="line">                &#123;</span><br><span class="line">                  <span class="keyword">if</span>(Limplay == <span class="keyword">false</span>)</span><br><span class="line">                  &#123;</span><br><span class="line">                         JOptionPane.showMessageDialog(jpl,</span><br><span class="line">                            <span class="string">&quot;1.圖片為 &quot;</span> + row + <span class="string">&quot; 乘 &quot;</span> + col +<span class="string">&quot; ，本關共有 &quot;</span> + (row * col) + <span class="string">&quot; 個按鈕\n&quot;</span> + </span><br><span class="line">                            <span class="string">&quot;2.一開始會讓玩家看 &quot;</span> + LK_SEC + <span class="string">&quot; 秒記圖片\n&quot;</span>+ </span><br><span class="line">                            <span class="string">&quot;3.翻錯圖片時，錯誤圖片會停留 &quot;</span> + sec+ <span class="string">&quot; 秒讓玩家記\n&quot;</span>+ </span><br><span class="line">                            <span class="string">&quot;4.猜對得 &quot;</span> + add + <span class="string">&quot; 分，猜錯扣 &quot;</span> + dec +<span class="string">&quot; 分\n&quot;</span> +</span><br><span class="line">                            <span class="string">&quot;5.關卡名稱顯示在左上方，關卡分數顯示在左下方\n&quot;</span> +</span><br><span class="line">                            <span class="string">&quot;6.全部共有三關&quot;</span> ,</span><br><span class="line">                            <span class="string">&quot;遊戲說明&quot;</span>,JOptionPane.PLAIN_MESSAGE,<span class="keyword">new</span> ImageIcon(getClass().getResource(<span class="string">&quot;images/BattleIcon.png&quot;</span>)));</span><br><span class="line">                   &#125;</span><br><span class="line">                 <span class="keyword">else</span></span><br><span class="line">                 &#123;</span><br><span class="line">                        JOptionPane.showMessageDialog(jpl,</span><br><span class="line">                          <span class="string">&quot;請努力達成以下條件:\n&quot;</span> + </span><br><span class="line">                          <span class="string">&quot;1.目標分數為滿分 〔 &quot;</span> + LimPoint + <span class="string">&quot; 〕 分\n&quot;</span>+ </span><br><span class="line">                          <span class="string">&quot;2.目標完成時間為 〔 &quot;</span> + LimSec+ <span class="string">&quot; 〕 秒\n&quot;</span>+ </span><br><span class="line">                          <span class="string">&quot;3.只要猜錯一次就會失敗\n&quot;</span> +</span><br><span class="line">                          <span class="string">&quot;4.以上兩個目標皆完成才會出現通關視窗\n&quot;</span>,</span><br><span class="line">                          <span class="string">&quot;極限關卡&quot;</span>,</span><br><span class="line">                          JOptionPane.PLAIN_MESSAGE,<span class="keyword">new</span> ImageIcon(getClass().getResource(<span class="string">&quot;images/BatLim.png&quot;</span>)));</span><br><span class="line">                        </span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span>(ae.getSource() == oth[<span class="number">1</span>])                               <span class="comment">//作者資訊與素材來源</span></span><br><span class="line">                &#123;</span><br><span class="line">                  JOptionPane.showMessageDialog(jpl,</span><br><span class="line">                  <span class="string">&quot;程式設計與介面修改：陳煜仁\n&quot;</span>+</span><br><span class="line">                          <span class="string">&quot;素材取得來源：https://granbluefantasy.jp/\n&quot;</span>+</span><br><span class="line">                          <span class="string">&quot;此程式僅用於學術研究，參考許多網路上資料完成\n&quot;</span>,</span><br><span class="line">                     <span class="string">&quot;作者資訊&quot;</span>,</span><br><span class="line">                      JOptionPane.PLAIN_MESSAGE,<span class="keyword">new</span> ImageIcon(getClass().getResource(<span class="string">&quot;images/ProgIcon.png&quot;</span>)));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//回傳一個存放1~N數值亂數陣列</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">int</span> [] rand(<span class="keyword">int</span> N)</span><br><span class="line">        &#123;</span><br><span class="line">         <span class="keyword">int</span> temp [] = <span class="keyword">new</span> <span class="keyword">int</span>[N];</span><br><span class="line">         </span><br><span class="line">         <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i++)</span><br><span class="line">         &#123;</span><br><span class="line">          	temp[i] = i;</span><br><span class="line">         &#125;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">int</span> j = (<span class="keyword">int</span>) (Math.random() * N);</span><br><span class="line">                <span class="keyword">int</span> tmp = temp[i];</span><br><span class="line">                temp[i] = temp[j];</span><br><span class="line">                temp[j] = tmp;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> temp;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//將記錄的圖片索引值0~N轉換為1~(N/2+1)</span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">imgIndex</span><span class="params">(<span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">         <span class="keyword">return</span> ((n/<span class="number">2</span>)+<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//開始(重玩)遊戲</span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">replay</span><span class="params">(<span class="keyword">boolean</span> lm,<span class="keyword">int</span> lev)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">                stage.setText(<span class="string">&quot;Round &quot;</span>+ lev+<span class="string">&quot;：&quot;</span>);</span><br><span class="line">                startTime = System.currentTimeMillis();</span><br><span class="line">         	gm[<span class="number">0</span>].setEnabled(<span class="keyword">false</span>);</span><br><span class="line">                <span class="keyword">if</span>(lm == <span class="keyword">true</span>)</span><br><span class="line">                    gm[<span class="number">4</span>].setEnabled(<span class="keyword">false</span>);</span><br><span class="line">         	gm[<span class="number">1</span>].setEnabled(<span class="keyword">true</span>);</span><br><span class="line">         	m = rand(row*col); 						<span class="comment">//取得按鈕下次重排的圖案順序</span></span><br><span class="line">              </span><br><span class="line">          </span><br><span class="line">         	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; img.length; i++)				<span class="comment">//設定所有圖片為可以翻狀態</span></span><br><span class="line">         	&#123;</span><br><span class="line">          	     imgbtn[i].setEnabled(<span class="keyword">true</span>);</span><br><span class="line">          	     imgbtn[i].setIcon(<span class="keyword">new</span> ImageIcon(getClass().getResource(<span class="string">&quot;images/&quot;</span> + imgIndex(m[i]) + <span class="string">&quot;.jpg&quot;</span>)));</span><br><span class="line">         	&#125;								</span><br><span class="line">         	twoImg[<span class="number">0</span>] = twoImg[<span class="number">1</span>] = btnIndex[<span class="number">0</span>] = btnIndex[<span class="number">1</span>] = -<span class="number">1</span>;		<span class="comment">//清除記錄兩張翻開圖片按鈕與位置</span></span><br><span class="line">         	isChange = <span class="keyword">false</span>; 						 <span class="comment">//重設翻牌順序</span></span><br><span class="line">         	score = <span class="number">0</span>; 								<span class="comment">//分數歸零</span></span><br><span class="line">         	jl.setText(<span class="string">&quot;分數 : &quot;</span> + score); 					<span class="comment">//更新顯示分數</span></span><br><span class="line">		   count=<span class="number">0</span>;</span><br><span class="line">         	isStart = <span class="keyword">false</span>;</span><br><span class="line">		</span><br><span class="line">         <span class="keyword">new</span> Thread(<span class="keyword">new</span> Runnable()</span><br><span class="line">         &#123;</span><br><span class="line">          <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span></span><br><span class="line"><span class="function">          </span>&#123;</span><br><span class="line">           <span class="keyword">try</span></span><br><span class="line">           &#123;</span><br><span class="line">               Thread.sleep(LK_SEC * <span class="number">1000</span>);</span><br><span class="line">            &#125;<span class="keyword">catch</span>(InterruptedException e)&#123;&#125;</span><br><span class="line">                                                                                <span class="comment">//將圖面改為預設圖，並設定無法按按鍵</span></span><br><span class="line">                    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; img.length; i++)</span><br><span class="line">                    &#123;</span><br><span class="line">                     img[i] = <span class="keyword">new</span> ImageIcon(getClass().getResource(<span class="string">&quot;images/p0.jpg&quot;</span>));</span><br><span class="line">                     imgbtn[i].setIcon(img[i]);</span><br><span class="line">                     btnDown[i] = <span class="keyword">false</span>;                                        <span class="comment">//將記錄過的按鈕清除</span></span><br><span class="line">                    &#125;</span><br><span class="line">                    isStart = <span class="keyword">true</span>;</span><br><span class="line">          &#125;</span><br><span class="line">         &#125;).start();</span><br><span class="line">         </span><br><span class="line">            <span class="comment">//清除上局存放配對成功的圖片位置</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; imgShow.length; i++)</span><br><span class="line">             imgShow[i] = <span class="keyword">false</span>;</span><br><span class="line">        &#125;   </span><br><span class="line">        <span class="comment">//檢查是目前兩張圖是否配對</span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">checkIsRight</span><span class="params">(<span class="keyword">int</span> btnN, <span class="keyword">int</span> jpgNum)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">        	 <span class="keyword">if</span>(!isStart) <span class="keyword">return</span>; 						<span class="comment">//判斷是否已讓玩家看完圖片排列，再開始</span></span><br><span class="line">        	 <span class="keyword">if</span>(btnDown[btnN]) <span class="keyword">return</span>;					<span class="comment">//如果按下的圖片已翻開，就離開function</span></span><br><span class="line">        	 btnDown[btnN] = <span class="keyword">true</span>; 						<span class="comment">//表示此按鈕已翻開狀態</span></span><br><span class="line">		</span><br><span class="line">        	 imgbtn[btnN].setIcon(<span class="keyword">new</span> ImageIcon(getClass().getResource(<span class="string">&quot;images/&quot;</span> + jpgNum + <span class="string">&quot;.jpg&quot;</span>)));     </span><br><span class="line">         </span><br><span class="line">             <span class="comment">//記錄上張與目前圖片編號、按鈕位置twoImg[1]是上一張，twoImg[0]是目前   </span></span><br><span class="line">        	 <span class="keyword">int</span> temp = twoImg[<span class="number">0</span>];                                                 </span><br><span class="line">         	 <span class="keyword">int</span> btnTemp = btnIndex[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">        	 twoImg[<span class="number">0</span>] = jpgNum;</span><br><span class="line">        	 btnIndex[<span class="number">0</span>] = btnN;</span><br><span class="line">        	 twoImg[<span class="number">1</span>] = temp;</span><br><span class="line">        	 btnIndex[<span class="number">1</span>] = btnTemp;</span><br><span class="line">             </span><br><span class="line">            	<span class="keyword">if</span>(isChange)</span><br><span class="line">           	 &#123;</span><br><span class="line">            		 <span class="keyword">if</span>(imgShow[jpgNum-<span class="number">1</span>]) </span><br><span class="line">				<span class="keyword">return</span>;                                         <span class="comment">//若已配對成功</span></span><br><span class="line">              		 <span class="keyword">if</span>(twoImg[<span class="number">1</span>] == twoImg[<span class="number">0</span>])</span><br><span class="line">          		 &#123;</span><br><span class="line">          		 	imgShow[jpgNum-<span class="number">1</span>] = <span class="keyword">true</span>;                       <span class="comment">//記錄已配對的圖片索引值</span></span><br><span class="line">          			twoImg[<span class="number">1</span>] = -<span class="number">1</span>;</span><br><span class="line">          		 	btnIndex[<span class="number">1</span>] = -<span class="number">1</span>;</span><br><span class="line">          		 	isChange = <span class="keyword">false</span>;</span><br><span class="line">			 	count++;                                        <span class="comment">//正確對數增加</span></span><br><span class="line">          		 	score += add; 							 <span class="comment">//配對成功分數增加</span></span><br><span class="line">           		 	jl.setText(<span class="string">&quot;分數 : &quot;</span> + score);             <span class="comment">//更新分數</span></span><br><span class="line">                                </span><br><span class="line">				<span class="keyword">if</span>(count == row*col/<span class="number">2</span>)</span><br><span class="line">                                &#123;</span><br><span class="line">                    Long t =((System.currentTimeMillis()-startTime)/<span class="number">1000</span>);</span><br><span class="line">                    usedtime.setText(((System.currentTimeMillis()-startTime)/<span class="number">1000</span>)+<span class="string">&quot;&quot;</span>);   </span><br><span class="line">                    <span class="keyword">if</span>(Limplay == <span class="keyword">false</span>)</span><br><span class="line">                    &#123;</span><br><span class="line">                        JOptionPane.showMessageDialog(jpl,</span><br><span class="line">                                                      <span class="string">&quot;恭喜通關！\n&quot;</span> + </span><br><span class="line">                                                      <span class="string">&quot;你本次遊戲花了【 &quot;</span> + usedtime.getText() + <span class="string">&quot; 】秒\n&quot;</span>+</span><br><span class="line">                                                      <span class="string">&quot;在這一關獲得總分數為【 &quot;</span>+score+<span class="string">&quot; 】分！!&quot;</span>,</span><br><span class="line">                                                      <span class="string">&quot;關卡訊息&quot;</span>,</span><br><span class="line">                                                      JOptionPane.PLAIN_MESSAGE,<span class="keyword">new</span> 							                                                                             ImageIcon(getClass().getResource(<span class="string">&quot;images/icon.png&quot;</span>)));</span><br><span class="line">					</span><br><span class="line">                                        &#125;</span><br><span class="line">                                        <span class="keyword">else</span></span><br><span class="line">                                        &#123;</span><br><span class="line">                                             <span class="keyword">if</span>(LimPoint  == score &amp;&amp; LimSec &gt;= t)</span><br><span class="line">                                             &#123;</span><br><span class="line">                                                            JOptionPane.showMessageDialog(jpl,</span><br><span class="line">                                                <span class="string">&quot;超越極限！！！\n&quot;</span> + </span><br><span class="line">                                                <span class="string">&quot;你的翻牌沒有絲毫猶豫！竟然只花了【 &quot;</span> + usedtime.getText() + <span class="string">&quot; 】秒\n&quot;</span>+</span><br><span class="line">                                                <span class="string">&quot;沒有任何錯誤的通關了！ 恭喜你！&quot;</span>,</span><br><span class="line">                                                <span class="string">&quot;極限關卡&quot;</span>,</span><br><span class="line">											JOptionPane.PLAIN_MESSAGE,<span class="keyword">new</span> ImageIcon(getClass().getResource(<span class="string">&quot;images/LimIcon1.png&quot;</span>)));</span><br><span class="line">                                              &#125;</span><br><span class="line">                                              <span class="keyword">else</span></span><br><span class="line">                                              &#123;</span><br><span class="line">                                                  <span class="keyword">int</span> x =JOptionPane.showConfirmDialog(jpl, <span class="string">&quot;可惜...\n你還沒達成所有條件....\n&quot;</span> + </span><br><span class="line">                                                  你本次遊戲花了【 <span class="string">&quot; + usedtime.getText() + &quot;</span> 】秒\n你獲得分數為【 <span class="string">&quot;+score+&quot;</span> 】分\n<span class="string">&quot;+</span></span><br><span class="line"><span class="string">                                                  &quot;</span>你還想要繼續挑戰嗎？<span class="string">&quot;,</span></span><br><span class="line"><span class="string">                                                  &quot;</span>極限關卡<span class="string">&quot;,                                                                               											JOptionPane.OK_CANCEL_OPTION,JOptionPane.INFORMATION_MESSAGE);</span></span><br><span class="line"><span class="string">                       </span></span><br><span class="line"><span class="string">                                                 if(x ==JOptionPane.YES_OPTION)</span></span><br><span class="line"><span class="string">                                                 &#123;</span></span><br><span class="line"><span class="string">                                                     replay(Limplay,level);</span></span><br><span class="line"><span class="string">                                                 &#125;                                          </span></span><br><span class="line"><span class="string">                			      &#125;</span></span><br><span class="line"><span class="string">                                        &#125;</span></span><br><span class="line"><span class="string">                                      </span></span><br><span class="line"><span class="string">                                &#125;</span></span><br><span class="line"><span class="string">           			return;</span></span><br><span class="line"><span class="string">          		 &#125;</span></span><br><span class="line"><span class="string">                                                                                //設定翻開兩張圖片時，其他圖片不能翻</span></span><br><span class="line"><span class="string">              		for(int i = 0; i &lt; btnDown.length; i++)</span></span><br><span class="line"><span class="string">               		    if(!btnDown[i]) imgbtn[i].setEnabled(false);</span></span><br><span class="line"><span class="string">             		new Thread(this).start();</span></span><br><span class="line"><span class="string">                 &#125;            </span></span><br><span class="line"><span class="string">         		isChange = !isChange;</span></span><br><span class="line"><span class="string">       &#125;        </span></span><br><span class="line"><span class="string">        public void run ()</span></span><br><span class="line"><span class="string">        &#123;</span></span><br><span class="line"><span class="string">          try&#123;   </span></span><br><span class="line"><span class="string">           Thread.sleep(sec * 1000);</span></span><br><span class="line"><span class="string">          &#125;catch(InterruptedException e)&#123;&#125;</span></span><br><span class="line"><span class="string">          </span></span><br><span class="line"><span class="string">                                                                                //蓋住原本翻開的圖片         </span></span><br><span class="line"><span class="string">      	 btnDown[btnIndex[0]] = false;                                      </span></span><br><span class="line"><span class="string">         btnDown[btnIndex[1]] = false;</span></span><br><span class="line"><span class="string">         imgbtn[btnIndex[0]].setIcon(new ImageIcon(getClass().getResource(&quot;</span>images/p0.jpg<span class="string">&quot;)));</span></span><br><span class="line"><span class="string">         imgbtn[btnIndex[1]].setIcon(new ImageIcon(getClass().getResource(&quot;</span>images/p0.jpg<span class="string">&quot;)));</span></span><br><span class="line"><span class="string">         </span></span><br><span class="line"><span class="string">                                                                                //設定蓋回兩張翻開圖片時，其他圖片可以回復可以翻的狀態</span></span><br><span class="line"><span class="string">         for(int i = 0; i &lt; btnDown.length; i++)</span></span><br><span class="line"><span class="string">           if(!btnDown[i]) imgbtn[i].setEnabled(true);</span></span><br><span class="line"><span class="string">         </span></span><br><span class="line"><span class="string">         score -= dec;                                                          //猜錯扣分</span></span><br><span class="line"><span class="string">         jl.setText(&quot;</span>分數 : <span class="string">&quot; + score); 	</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">      </span></span><br><span class="line"><span class="string">        public static void main(String [] args)</span></span><br><span class="line"><span class="string">        &#123;</span></span><br><span class="line"><span class="string">                new memorycard(0,1);</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>程式作品</category>
      </categories>
      <tags>
        <tag>Java</tag>
      </tags>
  </entry>
  <entry>
    <title>藍芽室內定位的可行性</title>
    <url>/2022/01/12/%E8%97%8D%E8%8A%BD%E5%AE%A4%E5%85%A7%E5%AE%9A%E4%BD%8D%E7%9A%84%E5%8F%AF%E8%A1%8C%E6%80%A7/</url>
    <content><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>大學專題有思考過類似的問題，並有實際去嘗試過才想寫這主題。</p>
<p>希望能給之後想做藍芽室內定位的人參考！</p>
<p><del>順便勸退專題想做藍芽室內定位的人</del></p>
<p>因為室內定位真的是一門很廣的學問，何況藍芽的訊號干擾太多了，實作起來能說是困難重重…</p>
<span id="more"></span>


<h1 id="專題簡介"><a href="#專題簡介" class="headerlink" title="專題簡介"></a>專題簡介</h1><p>大學專題的作品名稱是 『 行動導覽系統 』，</p>
<p>跟另外兩名大學同學一組，</p>
<p>我主要負責報告文件整理及統整其他技術研究等，</p>
<p>看過各種關於藍牙室內定位的論文或研究，</p>
<p>看到最後好像也沒有一個很完美的做法…</p>
<p>這邊放上當初做的海報擷取來說明主要功能<br><img src="https://i.imgur.com/9pIPg8F.png"></p>
<p>就是透過手機程式來定位到在特定位置的展物並顯示出展物資訊</p>
<p>聽起來好像很簡單但做了才發現問題很多…</p>
<ul>
<li>訊號精準度若偏差太大定位點會偏離</li>
<li>藍芽訊號太容易受干擾</li>
<li>距離不同收到的訊號強度也不同</li>
<li>放太近訊號會互相干擾</li>
<li>展覽場地不同要配置幾個才夠定位</li>
</ul>
<p>以下就用專題中遇到的不同技術困難點做分段說明。</p>
<h1 id="定位設備-Beacon"><a href="#定位設備-Beacon" class="headerlink" title="定位設備 - Beacon"></a>定位設備 - Beacon</h1><p>當初實驗室剛好手邊有這個 - 智石科技的Ｍax Beacon<br><img src="https://i.imgur.com/f4TlFY8.jpg" alt="Beacon"><br>設備規格如下圖所示<br><img src="https://i.imgur.com/U5vc8Mg.png"></p>
<p>防水防塵防震動，<br>提供App 可以搜尋調整Beacon訊號的強弱及推播頻率和看電池電量等功能。</p>
<p>每個 Beacon 都有獨立的一個編號(如：47044)</p>
<p>為什麼要採用這個，主要原因如下：</p>
<ol>
<li>單一設備便宜(約4.500元 / 個)</li>
<li>配置簡單(與無線訊號台AP比較)</li>
<li>藍芽已被廣大運用在各類產品</li>
<li>實驗室剛好有</li>
</ol>
<p>Beacon可以發送訊號給手機接收，不同距離的訊號強度也不同</p>
<p><strong>用這些不同的訊號強度來判斷使用者目前在場地的哪個地方</strong></p>
<h2 id="設備狀態"><a href="#設備狀態" class="headerlink" title="設備狀態"></a>設備狀態</h2><p>這些編號跟訊號強弱有關係，若壞掉的訊號就異常需排除在外</p>
<p>我們第一步做的就是從一堆 Beacon 中排除訊號異常的部分</p>
<p>廠商提供的訊號正常範圍為 -50 ~ -90 dBm(一公尺)</p>
<p>但又不能把他們放太近測試，<strong>藍芽訊號非常容易受干擾</strong></p>
<p>於是就分別量測不同編號的訊號強度，如下圖所示，</p>
<p><img src="https://i.imgur.com/orXyRnn.png" alt="編號訊號強度比較"></p>
<p>這資料是依 1m 不同推播頻率的Beacon來做比較，</p>
<p>使用 APP 調整編號的 TXPOWER(會影響訊號推播強度)，</p>
<p><strong>依這個數據將與其他人訊號有差異的裝置排除不使用</strong>。</p>
<h2 id="設備推播範圍"><a href="#設備推播範圍" class="headerlink" title="設備推播範圍"></a>設備推播範圍</h2><p>基本上 Beacon 的訊號可以超過 3 m 沒問題，</p>
<p>但室內並不需要那麼廣的推播範圍，</p>
<p>而前面也提到 TXPOWER 會影響訊號強度，</p>
<p>於是我們以 1 m 不同 TXPOWER 來看訊號變化，如圖所示，</p>
<p><img src="https://i.imgur.com/iVrncd0.png" alt="不同推播訊號強度"></p>
<p>可以看到 <strong>4dBm 是訊號強度最強的時候，越往下調整越弱</strong>。</p>
<h2 id="設備維持時間"><a href="#設備維持時間" class="headerlink" title="設備維持時間"></a>設備維持時間</h2><p>對於Beacon能維持正常狀態多少時間也有花時間測試，</p>
<p>具體狀況如下圖所示，以正常推播頻率放置超過半年，</p>
<p>4dBm是 TXPOWER 最強訊號強度的情況，</p>
<p><img src="https://i.imgur.com/GlU4VcD.png" alt="Beacon電池狀況"></p>
<p><strong>基本上跟三號電池的衰減曲線差不多符合，在續航力上不太需要擔心</strong>。</p>
<h1 id="Bluetooth-藍芽"><a href="#Bluetooth-藍芽" class="headerlink" title="Bluetooth 藍芽"></a>Bluetooth 藍芽</h1><p>作為室內定位的主技術，也有很長發展歷史…有興趣的就自己去研究吧</p>
<p>採用的是藍芽4.0後出現的 低功耗藍牙BLE 技術，比較如下圖，</p>
<p><img src="https://i.imgur.com/jJu1J48.png" alt="與傳統藍芽比較"></p>
<p>在找資料的時候發現藍芽是非常容易受干擾的東西，</p>
<p>什麼都會對訊號造成干擾，通常稱為多重訊號干擾，如下圖所示，</p>
<p><img src="https://i.imgur.com/FOhpGW1.jpg" alt="藍芽干擾"></p>
<p>那參考別人的論文後發現他們有有遇過類似的問題，</p>
<p>此時他們提出的解決方法是 - 訊號濾波，</p>
<p>將收到的訊號做一次過濾，也就是把過高或過低的訊號值移除，</p>
<p>濾波器也有很多種，像是均值濾波器跟卡爾曼濾波器等等</p>
<p>但均值濾波器在處理上反應時間較久，不適合用在即時處理的應用上，</p>
<p>所以我們採用的是卡爾曼濾波器，這裡就不贅述它的原理了，</p>
<p>經過濾波器處理後，訊號強度確實有變規律一點。</p>
<h2 id="定位方法"><a href="#定位方法" class="headerlink" title="定位方法"></a>定位方法</h2><p>室內定位也有很多方法被使用，定位的根據不同方法也不同，</p>
<p>我們這邊是採用 <strong>RSSI 接收強度定位法</strong>，</p>
<p>接收不同的訊號強度轉換成距離後透過三角定位法求出接收器的位置</p>
<p>稱為 RSSI 三點定位法也稱三角定位法。</p>
<p>但距離跟訊號強度的關係不明顯就會使定位不精準，</p>
<p>所以我們採用的是另一種稱為<strong>指紋定位法</strong>的方法，如圖所示，</p>
<p><img src="https://i.imgur.com/m0hfTBX.png" alt="指紋定位法"></p>
<p>用大量搜集不同區塊所收得的訊號強度當成區域特徵後儲存於資料庫，</p>
<p>需要定位時則透過當下收到的特徵去比對資料庫中較符合的區塊回傳。</p>
<h2 id="定位場域"><a href="#定位場域" class="headerlink" title="定位場域"></a>定位場域</h2><p>最一開始我們是用實驗室當場域，</p>
<p>呈現一個長方形，<del>然後訊號干擾超嚴重</del>，</p>
<p>後來選用學校的一間教室，平面圖如下，</p>
<p><img src="https://i.imgur.com/EnI61MP.png" alt="教室平面圖"></p>
<p>因為前面選用的定位方法，把這地方切成數區塊如下圖所示，</p>
<p><img src="https://i.imgur.com/GRHvAos.jpg" alt="切割教室圖"></p>
<p>大致上的想法是走到哪個地方那區塊就會發亮，</p>
<p>表示使用者現在走到這個區塊內了，可以顯示區塊的資訊。</p>
<h2 id="場域配置數量"><a href="#場域配置數量" class="headerlink" title="場域配置數量"></a>場域配置數量</h2><p>決定好場地後再來就是要配置幾顆 Beacon 才夠用了，</p>
<p>這時我看到成功大學有一篇論文在研究訊號特徵法，</p>
<p>就模仿他的方法來做我們的預估配置狀況，如下圖所示，</p>
<p>考慮過若配置3顆的情況，<br><img src="https://i.imgur.com/x2CpETR.png" alt="理論3顆配置"><br>或是配置4顆的情況，<br><img src="https://i.imgur.com/blrZVJ6.png" alt="理論4顆配置"></p>
<p>以顏色來分辨訊號強度，我的訊號強度顏色如下圖所示，</p>
<p><img src="https://i.imgur.com/XgwjlSe.png" alt="訊號強度顏色"></p>
<p>因為場地不大所以配置數量 4 顆就算多了，再往上會互相干擾…</p>
<p>那我們選用 3 顆的配置方法，</p>
<p>並開始去搜集這區塊的訊號強度到資料庫中。</p>
<h1 id="實作成果"><a href="#實作成果" class="headerlink" title="實作成果"></a>實作成果</h1><p>最後讓負責手機程式的同學開發後的成果如下圖，<br><img src="https://i.imgur.com/7ciy3bv.png" alt="App畫面-定位區塊"></p>
<p>假設場地上有各種畫作，若剛好Ａ4 區域有東西顯示，會如下圖所示，<br><img src="https://i.imgur.com/QTJwvEF.png" alt="App畫面-導覽畫面"></p>
<p>但有時候會定位在別的區塊上也是個問題，</p>
<p>定位精準度經過我們處理還是不高…</p>
<p>離實際要應用在導覽場域還有很大一段距離。</p>
<h1 id="結論"><a href="#結論" class="headerlink" title="結論"></a>結論</h1><p><del><strong>專題千萬不要做藍芽室內定位</strong></del></p>
<p>如果時間很多又想挑戰新領域的人可以嘗試，</p>
<p>但其中要花費的時間絕對遠超你的預期，</p>
<p>我很肯定你們大多數時間都在處理和調整非程式的因素</p>
<p>作為大學的畢業專題來說，</p>
<p>說真的超出一般大學生能處理的東西了，</p>
<p>考慮和影響的東西太多，什麼配置方法什麼地點都要自己決定，</p>
<p>技術成果不算完美，從裡面學到了不少實驗方法與解決問題的想法，</p>
<p>也感謝配合指導教授和我任性實驗要求的組員們，</p>
<p>提供給之後想做 <strong>藍芽室內定位</strong> 的人參考。</p>
<h1 id="參考文獻"><a href="#參考文獻" class="headerlink" title="參考文獻"></a>參考文獻</h1><p>這邊就提供當初寫報告有參考的論文，如圖所示，</p>
<p><img src="https://i.imgur.com/BHn5d52.png" alt="參考論文"></p>
<p>這些論文也給當初在研究的我們不少啟發，</p>
<p>有興趣的人也可以去看看！</p>
]]></content>
      <categories>
        <category>技術筆記</category>
      </categories>
      <tags>
        <tag>藍芽</tag>
        <tag>室內定位</tag>
      </tags>
  </entry>
  <entry>
    <title>關於網站作者</title>
    <url>/2021/04/05/%E9%97%9C%E6%96%BC%E7%B6%B2%E7%AB%99%E4%BD%9C%E8%80%85/</url>
    <content><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><h2 id="毫無反應，就只是一隻腦袋當機貓"><a href="#毫無反應，就只是一隻腦袋當機貓" class="headerlink" title="毫無反應，就只是一隻腦袋當機貓"></a>毫無反應，就只是一隻腦袋當機貓</h2><img src="/images/cat.jpg"  width="500" height="500">

<p><font color="#0072E3" size="5"><center>覺得人生苦不如就看貓吧</center></font></p>
<span id="more"></span>

<p>不常寫長文，不定時更新文章內容</p>
<h1 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h1><p>公立大學資訊工程系畢業</p>
<p>科技不斷在變，不吸收各類新科技的工程師真的很難活啊</p>
<p>目前在服兵役中</p>
<p>每天看其他社群大神的各種教學文</p>
<p>希望有天也能回饋廣大網路社會才開始更新自己的技術筆記</p>
<p>整理自己研究過的技術，順便再複習相關概念</p>
]]></content>
      <categories>
        <category>日記</category>
      </categories>
      <tags>
        <tag>日常廢文</tag>
      </tags>
  </entry>
</search>
